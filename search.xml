<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[11月内部建模比赛总结（一）评价风控的标准]]></title>
      <url>JuniorNi.github.io/2018/01/10/%E5%A6%82%E4%BD%95%E8%AF%84%E4%BB%B7%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BC%98%E5%8A%A3%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>好几个月都没写点东西，更新博客了。果然，懒惰是人类的天性啊！趁着记忆清晰，对前些日子部门内部的建模比赛进行知识梳理，总结经验与心得，加深印象，以备不时之需。</p>
<a id="more"></a>
<h1 id="评价风控（模型）的标准"><a href="#评价风控（模型）的标准" class="headerlink" title="评价风控（模型）的标准"></a>评价风控（模型）的标准</h1><h2 id="【混淆矩阵】"><a href="#【混淆矩阵】" class="headerlink" title="【混淆矩阵】"></a>【混淆矩阵】</h2><p>本次建模是关于<strong>风控反欺诈，对非金交易客户进行预测，判断是否为欺诈客户</strong>。这里暂先撇开风控建模相关的事宜，我们来谈谈评判风控的标准是什么。</p>
<p>最好的风控效果其实是<strong>在所有客户中能100%鉴别出欺诈客户</strong>，然而现实是：这样的判断力太难实现了。在我们认定欺诈的客户中必然会误杀部分“好”客户；而在认定的非欺诈客户中同样也存在漏网之鱼（欺诈客户）。</p>
<p>因此，这里我们需要引进<strong>混淆矩阵</strong>这个概念。</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">(预测)    1</th>
<th style="text-align:center">(预测)    0</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(真实)    1</td>
<td style="text-align:center">TP</td>
<td style="text-align:center">FN</td>
</tr>
<tr>
<td style="text-align:center">(真实)    0</td>
<td style="text-align:center">FP</td>
<td style="text-align:center">TN</td>
</tr>
</tbody>
</table>
<p>这里的0、1与网上关于混淆矩阵的介绍正好相反。大部分的资料都会把好客户作为把目标客户1，而我们的目标是要预测欺诈客户，所以<strong>欺诈客户为1，非欺诈客户为0</strong>。通过预测与真实的差异，得到以下4个指标：</p>
<ul>
<li><strong>TP：</strong>本身就是欺诈客户，同时也被判断为欺诈客户（True Positive）</li>
<li><strong>TN：</strong>本身是好客户，同时被判断为好客户（True Negative）</li>
<li><strong>FN：</strong>欺诈客户被认为是好客户，即漏网之鱼（False Negative）</li>
<li><strong>FP：</strong>好客户却被判为欺诈客户，即误杀掉的（False Positive）</li>
</ul>
<p>为了方便记忆这四个单词，可采取如下方法：<code>Positive/Negative</code>指的是预测的结果，如果预测准确，前面加上一个True（真）；预测错了的话就是False（假）。此外，由混淆矩阵又引出了以下两个概念（之后会有用到）：</p>
<ul>
<li><strong>召回率</strong>：简称为<strong>TPR</strong>，计算公式为<code>TPR=TP/(TP+FN)</code>——所有真实的“1”中，有多少被模型成功选出</li>
<li><strong>误报率</strong>：简称为<strong>FPR</strong>，计算公式为<code>FPR=FP/(FP+TN)</code>——所有真实的“0”中，有多少被模型误判成1</li>
</ul>
<p>假设现在我们已经有了一个预测模型，得到的是每个客户会发生欺诈的概率，同时画出一个关于欺诈概率的频数分布图，如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-609c5f5be169830c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>我们需要一个<strong>阈值</strong>，来划分欺诈与非欺诈用户。如果为50%，那么概率大于50%的都认为是欺诈用户（再次注意，这里的概率指的是欺诈的概率）；如果阈值调整至70%，原本概率为60%的欺诈客户“张三”，将会被判定为非欺诈。<strong>因此，阈值的选取至关重要！</strong></p>
<p>我们可以把原样本的欺诈/非欺诈客户分开，单独画频数分布图。对于欺诈客户的概率分布，我们给定一个评判的标准（阈值），则左侧灰色部分为FN（欺诈用户漏网了，认为是好人），右侧阴影部分为TP（本身为欺诈，认定为欺诈）。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-7a7a058bd77a8729.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>我们发现，无论阈值标准线往左往右移动，势必会导致TP(被正确判断的欺诈用户)与TN（被正确判断的非欺诈用户）一方增大与一方减小。这样也正解释了风控力度的大小。<strong>阈值标准线越往左，风险控制越苛刻，漏网之鱼（FN）就越小，但与此同时非欺诈客户量（TN）也越小，原本正常的客户被误判为欺诈（FP）的也越多。</strong></p>
<h2 id="【ROC与AUC】"><a href="#【ROC与AUC】" class="headerlink" title="【ROC与AUC】"></a>【ROC与AUC】</h2><p>那么阈值究竟这么取比较好呢？这其实是个很有考量的技术活。还记得我们之前提及的召回率（TPR）与误报率（FPR）么。在给定TPR的情况下，FPR越小，说明误判的“好人”越少；同理，在给定FPR（能接受一定好人误判的）的情况下，如果TPR越大，说明抓出来的“坏人”也越多。</p>
<p>假如阈值取0.6，我们把大于0.6的标记为1（违约），小于0.6的标记为0（正常），同时可以计算出TPR与FPR。同理，如果阈值换成了0.5，我们又得到一组（TPR2，FPR2）。<strong>于是，我们以FPR为横坐标，TPR为纵坐标，把不同的点连成一条曲线，就是ROC曲线。</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-5437b6e564ceed32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 400px;"></p>
<p>其实TPR与FPR是正相关的，也就是说：正确判断出“1”的数量增加，必然会付出代价（误判为“1”的FP也会增加）,ROC曲线上也能反映出这种变化趋势，从△TPR&gt;△FPR到△TPR&lt;△FPR。<font color="#FF0000">所以这里就回答了我们之前提出的问题：理想的阈值应该取△TPR=△FPR时所对应的阈值。</font></p>
<p>当我们有2个模型，画出了两条ROC曲线时，可以利用ROC曲线下的面积，即<strong>AUC或者C-统计量</strong>，来判断模型的效果。AUC越高，说明模型的分辨效果越好。</p>
<h2 id="【提升图与洛伦兹曲线】"><a href="#【提升图与洛伦兹曲线】" class="headerlink" title="【提升图与洛伦兹曲线】"></a>【提升图与洛伦兹曲线】</h2><p>除了ROC曲线与AUC指标，常用的模型评价还有<strong>K-S曲线</strong>，而K-S曲线又是由洛伦兹曲线变换之后得到，所以这里我们结合《信用风险评分卡》书中的例子来介绍相关概念。</p>
<p>假设10000笔借款，实际发生了700笔坏账。如果我们把10000笔随机分成10等分，那么每等分的坏账应该为70笔。</p>
<p>再假设我们有一个模型。通过这个模型，我们能给出每笔借款可能发生坏账的概率，<strong>将概率从高到低排序。</strong>排名越靠前的，发生坏账的可能性越大。我们对排好序的序列也分成10等分。<strong>那么应该是，越靠前的等份里，包含的坏人应该越多，越靠后的等份里，包含的坏人要更少（好人更多）。一个理想的模型，应该是这个排序与真实的排序是一样的，即，从一个分割点开始，靠前的都是坏人，靠后的都是好人。</strong></p>
<p>理想是美好的，然而现实是残酷的，我们总会误杀好人，也会漏掉坏人，能做的是把更多的坏人排到越前面。回到“提升图”相关内容，我们对之前排好序且10等份的数据计算各自等份内的违约数、占比与累计占比，如图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-085a06364ee555d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>把每份违约占比（实际与随机即第4与第7列）放到一张柱形图上，即<strong>提升图</strong>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-6a77987b07616dd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px;"></p>
<p>也可以将累计占比（实际与随机即第5与第8列）放到一张曲线上，即<strong>洛伦兹曲线。</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-9553fba362846c37.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px;"></p>
<p>有了洛伦兹曲线，我们就可以直观的比较两个模型的优劣了。我们在一张图上画上两个模型的洛伦兹曲线A与B，假定用户群体中真实的欺诈率是40%（即理想的模型中所有的违约用户全部集中在前4个等份）。我们可以看到，模型A识别出88%的违约用户，而B模型只能分离出78%的用户，所以模型A要比模型B效果好。<strong>所以以后我们只要看哪个模型越往“左上角鼓”，效果就越好。</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-a3836b3e2fcbd6bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 400px;"></p>
<h2 id="【K-S曲线】"><a href="#【K-S曲线】" class="headerlink" title="【K-S曲线】"></a>【K-S曲线】</h2><p>现在我们对“好人”，“坏人”分别画洛伦兹曲线，<strong>这两条曲线的差值，就是K-S曲线。</strong>如下图所示，假定我们选取阈值为20%（即认定概率大于20%的用户为违约用户），则该模型可以挑选出60%的违约用户，但同时会误判8%的“好人”。那么K-S曲线在违约率上的值就是60%-8%=52%。</p>
<p>K-S曲线主要是验证模型的区分能力，曲线中的最大值就是<strong>K-S统计量</strong>。K-S统计量越大，就越能把“好”“坏”区分开来，模型效果也就越好。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-01c470d9d65425fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 600px;"></p>
<p>我们再深入一层，针对60%与8%这两个数字细想一下：<strong>这60%不正是在设定20%阈值情况下，TPR的定义么。同理，8%对应着FPR。所以K-S曲线实际上就是以10%*k为横坐标，分别以TPR与FPR的值为纵坐标画出的两条曲线的差值。而KS=max(TPR-FPR)即两条曲线的最大差值，当KS最大时，也就是△TPR=△FPR，这不就是我们之前在ROC曲线上找到的最优阈值么？所以无论是ROC曲线还是K-S曲线，其本质上是一样的。</strong></p>
]]></content>
      
        <categories>
            
            <category> 机器学习 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 混淆矩阵 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[朴素贝叶斯-新闻文本分类]]></title>
      <url>JuniorNi.github.io/2017/09/09/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E2%80%94-%E6%96%B0%E9%97%BB%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/</url>
      <content type="html"><![CDATA[<h1 id="「朴素贝叶斯」"><a href="#「朴素贝叶斯」" class="headerlink" title="「朴素贝叶斯」"></a>「朴素贝叶斯」</h1><p>具体理论就不详细讲解了，网上一搜一大把。其核心思想就是： <strong>朴素贝叶斯 = 条件独立假设 + 贝叶斯方法</strong>。运行速度快，在满足分布独立这一假设条件下分类效果好，但对于训练集中没有出现过的词语要平滑处理，数值型变量特征默认符合正态分布。<br><a id="more"></a></p>
<h1 id="「Python实现」"><a href="#「Python实现」" class="headerlink" title="「Python实现」"></a>「Python实现」</h1><h2 id="导入停用词"><a href="#导入停用词" class="headerlink" title="导入停用词"></a>导入停用词</h2><p>导入停用词库，同时使用<code>strip()</code>方法剔除不需要的空白符，包括<code>（&#39;\n&#39;, &#39;\r&#39;, &#39;\t&#39;, &#39; &#39;）</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_word_set</span><span class="params">(words_file)</span>:</span></div><div class="line">    words_set = set()</div><div class="line">    <span class="keyword">with</span> codecs.open(words_file,<span class="string">'r'</span>,<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</div><div class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> fp:</div><div class="line">            word = line.strip()</div><div class="line">            <span class="keyword">if</span> len(word) &gt; <span class="number">0</span> <span class="keyword">and</span> word <span class="keyword">not</span> <span class="keyword">in</span> words_set:</div><div class="line">                words_set.add(word)</div><div class="line">    <span class="keyword">return</span> words_set</div></pre></td></tr></table></figure></p>
<h2 id="文本处理，样本生成"><a href="#文本处理，样本生成" class="headerlink" title="文本处理，样本生成"></a>文本处理，样本生成</h2><p>每个新闻文本txt文件在各自所属类别的文件夹中，结构如下：</p>
<blockquote>
<p>“folder_path”<br>　｜<br>　｜－－ C000008 －－ 1.txt / 2.txt / … / 19.txt<br>　｜－－ C000010<br>　｜－－ C000013<br>　｜－－ …<br>　｜－－ C000024</p>
</blockquote>
<p>这里使用<code>os.listdir()</code>读取指定目录下的所有文件夹名（即分类类别），遍历各自文件夹（类别）内的文本文件，对每一个txt文件进行文本切词，同时利用<code>zip()</code>函数使每个新闻文本与所属类别一一对应，一共有90条数据。</p>
<p>为了随机抽取训练与测试数据集，用<code>random.shuffle()</code>打乱顺序，并选取20%的数据用于测试，同时把特征数据与类别数据各自分开。</p>
<p>最后对训练数据集中的词语进行词频统计。这里有使用<code>sorted()</code>函数进行排序，方法为<code>sorted(iterable, cmp = None, key = None, reverse = False)</code>，其中参数含义如下：</p>
<ul>
<li><strong>iterable</strong>：是可迭代类型（我这里的可迭代类型为字典）</li>
<li><strong>cmp</strong>：用于比较的函数，比较什么由key决定（这里没用到）</li>
<li><strong>key</strong>：用列表元素的某个属性或函数进行作为关键字（这里使用字典中的“值”大小作为关键字排序）</li>
<li><strong>reverse</strong>：排序规则，True为降序（False为升序）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">text_processing</span><span class="params">(folder_path, test_size = <span class="number">0.2</span>)</span>:</span></div><div class="line">    folder_list = os.listdir(folder_path)</div><div class="line">    data_list = []</div><div class="line">    class_list = []</div><div class="line">    <span class="comment"># 遍历文件夹</span></div><div class="line">    <span class="keyword">for</span> folder <span class="keyword">in</span> folder_list:</div><div class="line">        new_folder_path = os.path.join(folder_path,folder)</div><div class="line">        files = os.listdir(new_folder_path)</div><div class="line">        j = <span class="number">1</span></div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</div><div class="line">            <span class="keyword">if</span> j &gt; <span class="number">100</span>: <span class="comment"># 防止内存爆掉</span></div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">with</span> codecs.open(os.path.join(new_folder_path, file), <span class="string">'r'</span>, <span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</div><div class="line">                raw = fp.read()</div><div class="line">                word_cut = jieba.cut(raw, cut_all = <span class="keyword">False</span>)</div><div class="line">                word_list = list(word_cut)</div><div class="line">                data_list.append(word_list) <span class="comment"># 训练集</span></div><div class="line">                class_list.append(folder)   <span class="comment"># 类别</span></div><div class="line">                j += <span class="number">1</span>      </div><div class="line"></div><div class="line">    <span class="comment"># 划分训练集和测试集</span></div><div class="line">    data_class_list = list(zip(data_list, class_list))</div><div class="line">    random.shuffle(data_class_list)    <span class="comment"># 打乱顺序</span></div><div class="line">    index = int(len(data_class_list) * test_size) + <span class="number">1</span>   <span class="comment"># 抽取测试数据集的占比</span></div><div class="line">    train_list = data_class_list[index:]</div><div class="line">    test_list = data_class_list[:index]</div><div class="line">    train_data_list,train_class_list = zip(*train_list) <span class="comment"># 特征与标签</span></div><div class="line">    test_data_list,test_class_list = zip(*test_list) </div><div class="line"></div><div class="line">    <span class="comment"># 统计词频</span></div><div class="line">    all_words_dict = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> word_list <span class="keyword">in</span> train_data_list:</div><div class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> word_list:</div><div class="line">            <span class="keyword">if</span> word <span class="keyword">in</span> all_words_dict:</div><div class="line">                all_words_dict[word] += <span class="number">1</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                all_words_dict[word] = <span class="number">1</span></div><div class="line">            </div><div class="line">    <span class="comment"># 降序排序（key函数）</span></div><div class="line">    all_words_tuple_list = sorted(all_words_dict.items(),key = <span class="keyword">lambda</span> f:f[<span class="number">1</span>], reverse = <span class="keyword">True</span>)</div><div class="line">    all_words_list = list(zip(*all_words_tuple_list))[<span class="number">0</span>]</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> all_words_list, train_data_list, test_data_list, train_class_list, test_class_list</div></pre></td></tr></table></figure>
<h2 id="特征选择"><a href="#特征选择" class="headerlink" title="特征选择"></a>特征选择</h2><p>这里我们仅选取词频坐高的1000个特征词（维度），并剔除数字与停用词。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">words_dict</span><span class="params">(all_words_list,deleteN,stopwords_set=set<span class="params">()</span>)</span>:</span></div><div class="line">    feature_words = []</div><div class="line">    n = <span class="number">1</span></div><div class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> range(deleteN,len(all_words_list),<span class="number">1</span>):</div><div class="line">        <span class="keyword">if</span> n &gt; <span class="number">1000</span>:    <span class="comment"># 最多取1000个维度</span></div><div class="line">            <span class="keyword">break</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> all_words_list[t].isdigit() <span class="keyword">and</span> all_words_list[t] <span class="keyword">not</span> <span class="keyword">in</span> stopwords_set <span class="keyword">and</span> <span class="number">1</span> &lt; len(all_words_list[t]) &lt; <span class="number">5</span>:</div><div class="line">            feature_words.append(all_words_list[t])</div><div class="line">            n += <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> feature_words</div></pre></td></tr></table></figure></p>
<h2 id="用选取的特征词构建0-1矩阵"><a href="#用选取的特征词构建0-1矩阵" class="headerlink" title="用选取的特征词构建0-1矩阵"></a>用选取的特征词构建0-1矩阵</h2><p>对训练数据集train_data_list中每篇切完词之后的文档构建特征向量（由上述1000个特征词组成），若出现则取值为1，否则为0。于是90篇文章构建出了[90,1000]维度的0-1矩阵（其中71行为训练数据，19行为测试数据）。</p>
<p>训练集如下：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-ecf24ef5e855b0f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px;"></p>
<p>0-1矩阵如下：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-a40a8ecd7497d7db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 400px;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">text_features</span><span class="params">(train_data_list, test_data_list, feature_words)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">text_features</span><span class="params">(text,feature_words)</span>:</span></div><div class="line">        <span class="comment"># text = train_data_list[0]</span></div><div class="line">        text_words = set(text)</div><div class="line">        features = [<span class="number">1</span> <span class="keyword">if</span> word <span class="keyword">in</span> text_words <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> word <span class="keyword">in</span> feature_words]</div><div class="line">        <span class="keyword">return</span> features</div><div class="line">        </div><div class="line">    <span class="comment"># 0,1的矩阵（1000列-维度）    </span></div><div class="line">    train_feature_list = [text_features(text, feature_words) <span class="keyword">for</span> text <span class="keyword">in</span> train_data_list]</div><div class="line">    test_feature_list = [text_features(text, feature_words) <span class="keyword">for</span> text <span class="keyword">in</span> test_data_list]</div><div class="line">    <span class="keyword">return</span> train_feature_list,test_feature_list</div></pre></td></tr></table></figure>
<h2 id="朴素贝叶斯分类器"><a href="#朴素贝叶斯分类器" class="headerlink" title="朴素贝叶斯分类器"></a>朴素贝叶斯分类器</h2><p>这里使用开源sklearn库中的朴素贝叶斯分类器，输入参数分别为训练集的0-1特征矩阵（train_feature_list）与训练集分类（train_class_list），然后对测试数据的输出与真实结果进行比较，得到准确度为0.68</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">text_classifier</span><span class="params">(train_feature_list,test_feature_list,train_class_list,test_class_list)</span>:</span></div><div class="line">    <span class="comment"># sklearn多项式分类器</span></div><div class="line">    classifier = MultinomialNB().fit(train_feature_list,train_class_list)   <span class="comment"># 特征向量与类别</span></div><div class="line">    test_accuracy = classifier.score(test_feature_list,test_class_list)</div><div class="line">    <span class="keyword">return</span> test_accuracy</div></pre></td></tr></table></figure>
<p>这里我们仅选取词频最高的1000个作为特征向量，不妨尝试下选取其他的关键字作为特征向量，发现准确率都在0.63以上，分类效果还算可以，见下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-a1c4d9a911f69407.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="comment"># 文本预处理（分词、划分训练与测试集、排序）</span></div><div class="line">    folder_path = <span class="string">'...'</span></div><div class="line">    all_words_list, train_data_list, test_data_list, train_class_list, test_class_list = text_processing(folder_path, test_size = <span class="number">0.2</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># stopwords_set</span></div><div class="line">    stopwords_file = <span class="string">'...'</span></div><div class="line">    stopwords_set = make_word_set(stopwords_file)</div><div class="line"></div><div class="line">    <span class="comment"># 特征提取与分类</span></div><div class="line">    deleteNs = range(<span class="number">0</span>,<span class="number">1000</span>,<span class="number">20</span>)</div><div class="line">    test_accuracy_list = []</div><div class="line">    <span class="keyword">for</span> deleteN <span class="keyword">in</span> deleteNs:</div><div class="line">        <span class="comment"># 选取1000个特征</span></div><div class="line">        feature_words = words_dict(all_words_list,deleteN,stopwords_set)</div><div class="line">        <span class="comment"># 计算特征向量</span></div><div class="line">        train_feature_list, test_feature_list = text_features(train_data_list,test_data_list,feature_words)</div><div class="line">        <span class="comment"># sklearn分类器计算准确度</span></div><div class="line">        test_accuracy = text_classifier(train_feature_list,test_feature_list,train_class_list,test_class_list)</div><div class="line">        <span class="comment"># 不同特征向量下的准确度</span></div><div class="line">        test_accuracy_list.append(test_accuracy)</div><div class="line">    print(test_accuracy_list)</div><div class="line"></div><div class="line">    <span class="comment"># 结果评价</span></div><div class="line">    plt.figure()</div><div class="line">    plt.plot(deleteNs,test_accuracy_list)</div><div class="line">    plt.title(<span class="string">'Relationship of deleteNs and test_accuracy'</span>)</div><div class="line">    plt.xlabel(<span class="string">'deleteNs'</span>)</div><div class="line">    plt.ylabel(<span class="string">'test_accuracy'</span>)</div><div class="line">    plt.savefig(<span class="string">'result.png'</span>,dpi = <span class="number">100</span>)</div><div class="line">    plt.show()</div></pre></td></tr></table></figure>
<h1 id="「参考资料」"><a href="#「参考资料」" class="headerlink" title="「参考资料」"></a>「参考资料」</h1><blockquote>
<p><a href="http://blog.csdn.net/longxinchen_ml/article/details/50597149" target="_blank" rel="external">用朴素贝叶斯进行文本分类</a><br><a href="http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html" target="_blank" rel="external">朴素贝叶斯分类器的应用</a> </p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 机器学习 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> 机器学习 </tag>
            
            <tag> NLP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《小岛经济学》读书笔记（四）]]></title>
      <url>JuniorNi.github.io/2017/08/26/%E3%80%8A%E5%B0%8F%E5%B2%9B%E7%BB%8F%E6%B5%8E%E5%AD%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="量化宽松"><a href="#量化宽松" class="headerlink" title="量化宽松"></a>量化宽松</h1><p>其本质是向金融市场注入新的资金，来推动价格上涨。实际上，就是通货膨胀的委婉说法，是将政府债务货币化的隐秘手段。文中作者把它比喻成用汽油去救火，汽油越多，火势也就越大。<strong>如果不知道汽油是可燃物，我们也许会得出这样的结论：火没有被扑灭是因为汽油的量还不够大。</strong></p>
<h1 id="总结与启示"><a href="#总结与启示" class="headerlink" title="总结与启示"></a>总结与启示</h1><p>作者对于经济的核心思想：<strong>需求才是促进经济增长的真正动力，而非消费</strong>。增大货币量固然会鼓励人们消费，但对扩大需求毫无裨益。</p>
<h2 id="构建属于自己的捕鱼器并不断优化"><a href="#构建属于自己的捕鱼器并不断优化" class="headerlink" title="构建属于自己的捕鱼器并不断优化"></a>构建属于自己的捕鱼器并不断优化</h2><p>资本（工具）的产生提高了产出与效率，让你有更多的储蓄与时间做更有创造力的事情。对于我们自身，应该建立自己的专业性与知识体系，而非像徒手捕鱼的渔民，陷入低产出的工作中。</p>
<h2 id="重视储蓄的价值"><a href="#重视储蓄的价值" class="headerlink" title="重视储蓄的价值"></a>重视储蓄的价值</h2><p>了解自身的收入与支出，合理并结构化自己的支出与储蓄比例。但是有的消费却不能省，如孝顺父母的钱，对自己的投资（ROI是最大的）。</p>
<h2 id="了解市场-行业的供需关系"><a href="#了解市场-行业的供需关系" class="headerlink" title="了解市场/行业的供需关系"></a>了解市场/行业的供需关系</h2><p>你的价值是根据市场需求来决定的。符合市场需求并且稀缺，那么你的价值就越大。</p>
]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《小岛经济学》读书笔记（三）]]></title>
      <url>JuniorNi.github.io/2017/07/31/%E3%80%8A%E5%B0%8F%E5%B2%9B%E7%BB%8F%E6%B5%8E%E5%AD%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4762054-8947bc8e582cfe77.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="第七-十一章"><a href="#第七-十一章" class="headerlink" title="第七~十一章"></a>第七~十一章</h1><h2 id="自由贸易的优势"><a href="#自由贸易的优势" class="headerlink" title="自由贸易的优势"></a>自由贸易的优势</h2><p>扩大的选择范围（进口的T恤比本土要便宜），可以让美国人花更少的钱在T恤上。而省下来的钱可用于生产其他东西，这对于那些能输送最有价值产品的公司也是有利的。</p>
<p>由于本土的（T恤）企业无法找到竞争优势，工人会下岗。<strong>但经济的目的并非提供就业岗位，而是不断提高生产力。</strong>浪费劳动力制造那些国外生产率更高的产品是毫无意义的，应该找到自己更具优势的行业（更擅长制造的产品）。</p>
<a id="more"></a>
<h2 id="关于美联储"><a href="#关于美联储" class="headerlink" title="关于美联储"></a>关于美联储</h2><p>1913年，美联储成立，发行纸币，并承诺持有者可以随时兑换黄金。其最初目的是<em>“弹性货币供应”</em>：根据经济活动的情况，扩大或收紧货币的流通量，从而让物价保持平稳，不收繁荣或萧条的影响。</p>
<p>然而过去的100年里，物价上涨、货币的贬值（货币购买力下降），美元损失了超过95%的价值。美国人手里仅持有一种没有实际价值且可以随意增发的货币。</p>
<h2 id="通货膨胀"><a href="#通货膨胀" class="headerlink" title="通货膨胀"></a>通货膨胀</h2><p>岛上捕鱼的增长率远低于发行纸币的增长率，于是“通鱼膨胀”的难题产生了，物价上涨。</p>
<p>很多人认为物价上涨就是通货膨胀，其实不然，上涨的价格只是通货膨胀的结果罢了。<strong>通货膨胀其实就是货币供应量增加，货币紧缩就是货币供应量收紧。</strong></p>
<p>政府面对经济衰退的本能反应是造更多的纸币，因为经济学家认为物价下跌会导致经济陷入需求崩溃的万丈深渊。但事实是，<strong>物价需要下跌才能平衡正在衰退的经济局势</strong>。当经济不景气时，人们会停止消费，物价下跌。当跌到一定程度，人们又会开始消费。整个过程淘汰了不必要的产能，并把物价调整到了符合内在供求关系的水平。</p>
]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《小岛经济学》读书笔记（二）]]></title>
      <url>JuniorNi.github.io/2017/07/26/%E3%80%8A%E5%B0%8F%E5%B2%9B%E7%BB%8F%E6%B5%8E%E5%AD%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="第五、六章"><a href="#第五、六章" class="headerlink" title="第五、六章"></a>第五、六章</h1><h2 id="生产效率"><a href="#生产效率" class="headerlink" title="生产效率"></a>生产效率</h2><p>由于生产效率的提升（储蓄、创新与投资的结果），产品的价格也随之下降，于是更多的顾客可以去消费购买，昔日的奢侈品也成了普通消费品。</p>
<h2 id="工作与薪资"><a href="#工作与薪资" class="headerlink" title="工作与薪资"></a>工作与薪资</h2><p>由于岛上经济的多样化与社会分工的加剧，大多数劳动者会选择为别人工作（就业），用劳动换取报酬（薪资）。那么如何衡量劳动者的劳动价值？</p>
<ul>
<li>需求</li>
<li>供应</li>
<li>生产效率</li>
</ul>
<p>所以想要获得较高的薪资，必须要提高自身价值，要么掌握稀缺的能力，要么通过刻意练习提高工作效率与熟练度。</p>
<a id="more"></a>
<h2 id="利率"><a href="#利率" class="headerlink" title="利率"></a>利率</h2><p>政府不但可以通过政策的倾向性扰乱信贷市场，还可以通过<strong>操控利率</strong>影响信贷市场。政府被授予这一权利的背后是为了保证经济的平稳运行（无论是繁荣还是萧条期）。其理论基础是：美联储的经济学家能运用集体智慧，推算出特定时点最理想的利率水平，从而使经济正常运行。</p>
<p>但这一机制有两个致命的<strong>缺陷</strong>：</p>
<ul>
<li><p>美联储与利率没有任何关系，既不产生储蓄，也不为坏账而蒙受损失。没有这种关联，真的能比市场更清楚什么事恰当的利率水平么？</p>
</li>
<li><p>美联储的决定基于政治考量多于经济因素。因为低利率能让经济表面上表现更好。但事实是，过低的利率会传达出错误的信号，误以为经济状态良好、投资可行。结果就是虚假的繁荣之后出现巨大的危机。</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《小岛经济学》读书笔记（一）]]></title>
      <url>JuniorNi.github.io/2017/07/24/%E3%80%8A%E5%B0%8F%E5%B2%9B%E7%BB%8F%E6%B5%8E%E5%AD%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4762054-3aa8a61e987c99fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="第一、二章：工具的出现改变了一切"><a href="#第一、二章：工具的出现改变了一切" class="headerlink" title="第一、二章：工具的出现改变了一切"></a>第一、二章：工具的出现改变了一切</h1><h2 id="关于资本与储蓄"><a href="#关于资本与储蓄" class="headerlink" title="关于资本与储蓄"></a>关于资本与储蓄</h2><p>资本（设备）的建设与使用本身并没有什么意义，价值在于利用资本制造所需之物。同时带来的是生产力的提高，从而获得储蓄与积累（剩余价值）。</p>
<h2 id="关于经济"><a href="#关于经济" class="headerlink" title="关于经济"></a>关于经济</h2><p>最基本的定义：努力使有限的资源来产生最大的效益，尽可能满足人类的需求。<strong>工具</strong>、<strong>资本</strong>、<strong>创新</strong>是实现这一目标的关键。</p>
<p>经济增长的原因：<strong>找到了生产人类所需物品的更好方式</strong>。</p>
<a id="more"></a>
<h2 id="关于财富"><a href="#关于财富" class="headerlink" title="关于财富"></a>关于财富</h2><p>财富从来就是一个相对的概念。有人认为现在的贫富差距越来越大，但我们也要同时看到好的一面。整个社会的财富在变多，以前只有富人才能坐的起马车，现在基本人人都有能力买车，唯一区别在于品牌。即便是在中世纪最至高无上的国王眼里也是缺乏的各类娱乐设施，在如今的社会几乎人人都能享受。</p>
<p>富人真正致富的原因是<strong>为他人提供有价值的东西并承担一定的风险</strong>，文中艾伯不工作获得的利润是对他出借储蓄（鱼）所承风险的补偿（不还鱼）。</p>
<h2 id="总结成一句话"><a href="#总结成一句话" class="headerlink" title="总结成一句话"></a>总结成一句话</h2><p>工具提高生产力，生产力提高了，获得剩余价值，剩余价值引发借贷，借贷产生经济，经济发展促进财富积累。</p>
<h1 id="第三、四章：该不该存钱？"><a href="#第三、四章：该不该存钱？" class="headerlink" title="第三、四章：该不该存钱？"></a>第三、四章：该不该存钱？</h1><h2 id="积累储蓄的重要性"><a href="#积累储蓄的重要性" class="headerlink" title="积累储蓄的重要性"></a>积累储蓄的重要性</h2><ul>
<li>提高个人的消费能力，实现人生更多可能的方式，比如所走就走的一场旅行。</li>
<li>防止经济受到意外因素的缓冲器。</li>
</ul>
<h2 id="消费与储蓄"><a href="#消费与储蓄" class="headerlink" title="消费与储蓄"></a>消费与储蓄</h2><p>消费是只是用来衡量生产的尺度，因为生产的最终目的是消费。为了消费而消费并不会推动经济增长，就如花了100万买了一堆空气（并不是你真正需要的），虽然这100万算进了GDP中(同时表明不能仅用GDP来衡量经济是否增长)。必须要生产出有价值的东西（人们需要的），才能使消费有价值，经济才能增长。</p>
<p>然而储蓄创造了资本，资本使生产扩大成为了可能。所以从某种意义上，储蓄起来的一美元对经济产生的积极影响要大于消费掉的一美元。</p>
]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[天姥徒步行]]></title>
      <url>JuniorNi.github.io/2017/05/30/%E5%A4%A9%E5%A7%A5%E5%BE%92%E6%AD%A5%E8%A1%8C/</url>
      <content type="html"><![CDATA[<p><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%90%88%E7%85%A7.jpg" class="full-image"></p>
<h1 id="「序」"><a href="#「序」" class="headerlink" title="「序」"></a>「序」</h1><p>海客谈瀛洲，烟涛微茫信难求。<br>越人语天姥，云霞明灭或可睹……</p>
<p>这首太白诗中的天姥山便是我们此行的目的地。</p>
<a id="more"></a>
<h1 id="「随便说些什么」"><a href="#「随便说些什么」" class="headerlink" title="「随便说些什么」"></a>「随便说些什么」</h1><p>四个小伙伴跟随着稻草人的步伐，来了次虐身的登山~~~（谁让我们平时没怎么锻炼）</p>
<h2 id="Day-1"><a href="#Day-1" class="headerlink" title="#Day 1"></a>#Day 1</h2><p>解决了午饭，顺利抵达山脚，开始此次登山之旅。<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094130.jpg" class="full-image"></p>
<p>上山走累了，便随地憩息。清泉真的好冰凉，直接饮用也无碍。<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530110324.jpg" style="width: 250px;"></p>
<p><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094223.jpg" style="width: 250px;"></p>
<p>沿途的风景让人回归自然，心情舒畅，一片盎然生机的景象。<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094219.jpg" class="full-image"></p>
<p>感觉就如李太白所说“身登青云梯”这种感觉<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094121.jpg" style="width: 250px;"></p>
<p>晚上的“狼人杀”欢乐多多，尤其是我左右两边的女巫与预言家，你们要给力、好好带队啊~<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530093817.jpg
" class="full-image"></p>
<p>看着浩瀚的星空，渐渐入睡……<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530112836.jpg
" class="full-image"></p>
<h2 id="Day-2"><a href="#Day-2" class="headerlink" title="#Day 2"></a>#Day 2</h2><p>第二天早上补充能量之后，开始了崎岖的下山之旅。<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094107.jpg
" class="full-image"></p>
<p>你在桥上看风景，看风景的人在楼上看你。 明月装饰了你的窗， 而你装饰了别人的梦。<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094101.jpg
" class="full-image"></p>
<p>爱笑的女生运气总不会太差<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094044.jpg
" class="full-image"></p>
<p>游览沃洲湖<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530093950.jpg" class="full-image"></p>
<p>这一刻的定焦，希望能保持永远永远<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094007.jpg" class="full-image"></p>
<p>最后放上笑得有点傻傻、永远18岁的giver!<br><img src="http://ommtyfkn6.bkt.clouddn.com/2017-05-28%E5%A4%A9%E5%A7%A5%E5%B1%B1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20170530094030.jpg" class="full-image"></p>
<h1 id="「后记」"><a href="#「后记」" class="headerlink" title="「后记」"></a>「后记」</h1><p>恰同学少年，风华正茂，书生意气，挥斥方遒。指点江山，激扬文字，粪土当年万户侯。<br>愿我们始终怀有一颗赤子之心。</p>
]]></content>
      
        <categories>
            
            <category> 生活随记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 游记 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[D3学习系列（三） 桑基图]]></title>
      <url>JuniorNi.github.io/2017/04/15/D3%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%89%EF%BC%89-%E6%A1%91%E5%9F%BA%E5%9B%BE/</url>
      <content type="html"><![CDATA[<h1 id="「前言」"><a href="#「前言」" class="headerlink" title="「前言」"></a>「前言」</h1><p>网上关于桑基图的例子也有一些，但是对于初入门的新手并不友好、易懂。如果仅用百度搜索，资料更是少得可怜（这里感谢同事推荐shadowsocks进行科学上网●^●）。当然有些语句没有看懂，anyway先实现了再说~</p>
<a id="more"></a>
<h1 id="「什么是桑基图」"><a href="#「什么是桑基图」" class="headerlink" title="「什么是桑基图」"></a>「什么是桑基图」</h1><p>桑基图（Sankey diagram），即桑基能量分流图，主要是用来描述能量、人口、经济等的流动情况。因1898年Matthew Henry Phineas Riall Sankey绘制的“蒸汽机的能源效率图”而闻名，此后便以其名字命名为“桑基图”。</p>
<p>桑基图主要关注能量、物料或资本等在系统内部的流动和转移情况。Sankey diagram的特点有：</p>
<ul>
<li>起始流量和结束流量相同</li>
<li>在内部，不同的线条代表了不同的流量分流情况，它的宽度成比例地显示此分支占有的流量</li>
<li>节点不同的宽度代表了特定状态下的流量大小</li>
</ul>
<p> 在数据可视化中，桑基图有利于展现分类维度间的相关性，以流的形式呈现共享同一类别的元素数量。特别适合表达集群的发展，比如展示特定群体的人数分布等。我们可以欣赏下利用桑基图展示的可视化作品，太美了简直！</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/4762054-a86a3b3a710eaaaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px"></p>
<p>  <img src="http://upload-images.jianshu.io/upload_images/4762054-108913244ee48d91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px"></p>
<p>  <img src="http://upload-images.jianshu.io/upload_images/4762054-c6be2aebec0951a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<h1 id="「绘制桑基图」"><a href="#「绘制桑基图」" class="headerlink" title="「绘制桑基图」"></a>「绘制桑基图」</h1><h2 id="绘制画布SVG"><a href="#绘制画布SVG" class="headerlink" title="绘制画布SVG"></a>绘制画布SVG</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> margin = &#123;<span class="attr">top</span>: <span class="number">1</span>, <span class="attr">right</span>: <span class="number">1</span>, <span class="attr">bottom</span>: <span class="number">6</span>, <span class="attr">left</span>: <span class="number">1</span>&#125;,</div><div class="line">	width = <span class="number">1000</span> - margin.left - margin.right,</div><div class="line">	height = <span class="number">650</span> - margin.top - margin.bottom;</div><div class="line"></div><div class="line"><span class="keyword">var</span> formatNumber = d3.format(<span class="string">",.0f"</span>),   <span class="comment">// 数字转字符串 逗号分隔，0位小数点</span></div><div class="line">    format = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;<span class="keyword">return</span> formatNumber(d) + <span class="string">"m CHF"</span>;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> color = d3.scale.category20();</div><div class="line"></div><div class="line"><span class="keyword">var</span> svg = d3.select(<span class="string">"#chart"</span>)<span class="comment">//ID选择器</span></div><div class="line">    .append(<span class="string">"svg"</span>)</div><div class="line">    .attr(<span class="string">"width"</span>, width + margin.left + margin.right)</div><div class="line">    .attr(<span class="string">"height"</span>, height + margin.top + margin.bottom)</div><div class="line">    .append(<span class="string">"g"</span>)</div><div class="line">    .attr(<span class="string">"transform"</span>, <span class="string">"translate("</span> + margin.left + <span class="string">","</span> + margin.top + <span class="string">")"</span>);</div></pre></td></tr></table></figure>
<p>在body中定义一个<code>&lt;p&gt;</code>元素，令<code>id=&quot;chart&quot;</code>，画布SVG作用在元素<code>&lt;p&gt;</code>中，保持有一定的margin。</p>
<h2 id="定义桑基布局"><a href="#定义桑基布局" class="headerlink" title="定义桑基布局"></a>定义桑基布局</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sankey = d3.sankey()</div><div class="line">                .nodeWidth(<span class="number">25</span>)  <span class="comment">// 节点宽度</span></div><div class="line">                .nodePadding(<span class="number">20</span>)    <span class="comment">// 矩形垂直方向的间距</span></div><div class="line">                .size([width,height]);</div><div class="line"></div><div class="line"><span class="keyword">var</span> path = sankey.link();</div></pre></td></tr></table></figure>
<p><code>sankey.link()</code>函数应该是插件sankey.js中定义好的，目的是生成节点相对应的路径。</p>
<h2 id="绑定数据"><a href="#绑定数据" class="headerlink" title="绑定数据"></a>绑定数据</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">d3.json(<span class="string">"http://benlogan1981.github.io/VerticalSankey/data/ubs.json"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, energy</span>) </span>&#123;</div><div class="line">    sankey</div><div class="line">        .nodes(energy.nodes)	<span class="comment">// 绑定节点数据</span></div><div class="line">        .links(energy.links)	<span class="comment">// 绑定路径数据</span></div><div class="line">        .layout(<span class="number">32</span>);	<span class="comment">// iterations ?</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>这里我们通过引用外部JS数据的方式来绑定，之后直接使用<code>energy.</code>的方式调用，方式如下：<code>d3.json(&quot;XXX.json&quot;, function(error, energy) {};</code></p>
<p><strong>注意</strong><br>如果不启动外部服务器，是没有办法加载外部数据的。由于Python自带的包可以建立简单的Web服务器，便直接用Python：</p>
<ul>
<li>命令行中直接CD到准备做服务器的根目录下，输入命令：<code>python -m SimpleHTTPServer 8080</code>（这里使用的2.X版本，3.X版本稍有不同）</li>
<li>然后就可以在浏览器中输入：<code>http://localhost:8080/路径</code>来访问服务器的资源</li>
</ul>
<p><strong>JSON数据</strong><br>这里的JSON数据长这样：</p>
<blockquote>
<p>{“nodes”:[<br>{“name”:”Wealth Management”},<br>{“name”:”WMA”},<br>…<br>{“name”:”Switzerland”}<br>],<br>“links”:[<br>{“source”:0,”target”:5,”value”:100},<br>{“source”:1,”target”:5,”value”:1800},<br>….<br>{“source”:4,”target”:8,”value”:400}<br>]}</p>
</blockquote>
<p>nodes表示节点数据；links表示连线数据，其中source为起始节点，target表示终点节点，value为量的大小。关于<code>.layout()</code>，查了相关资料，好像是跟计算出来的节点与路径数据的迭代次数（iterations）有关，但是调整参数值并没有发现什么变化。</p>
<h2 id="绘制路径数据links"><a href="#绘制路径数据links" class="headerlink" title="绘制路径数据links"></a>绘制路径数据links</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> link = svg.append(<span class="string">"g"</span>).selectAll(<span class="string">"path"</span>)</div><div class="line">                .data(energy.links)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"path"</span>)</div><div class="line">                .attr(<span class="string">"class"</span>,<span class="string">"link"</span>)</div><div class="line">                .attr(<span class="string">"d"</span>,path)	<span class="comment">// 路径链接已被sankey封装好</span></div><div class="line">                .style(<span class="string">"stroke-width"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="built_in">Math</span>.max(<span class="number">1</span>,d.dy);</div><div class="line">                &#125;)</div><div class="line">                .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    <span class="keyword">return</span> d.source.color = color(d.source.name.replace(<span class="regexp">/ .*/</span>,<span class="string">""</span>));</div><div class="line">                &#125;)</div><div class="line">                .sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">                    <span class="keyword">return</span> b.dy - a.dy;</div><div class="line">                &#125;)</div><div class="line">                ;</div><div class="line"></div><div class="line">link.append(<span class="string">"title"</span>)</div><div class="line">    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> d.source.name + <span class="string">"-&gt;"</span> + d.target.name + <span class="string">"\n"</span> + format(d.value) ;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p><code>stroke-width</code>参数表示links的宽度，返回的是1和dy中的最大值，但大部分情况都会返回dy。如果换成10（这样每根连线都是一样宽度），看一下效果就知道<code>stroke-width</code>的作用了：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-86d9661ae63af5b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px"></p>
<p><code>stroke</code>其实是描边的意思，感觉由于header部分设置过了<code>fill：none</code>，所以才默认为填充的颜色。这里设置<font color="#FF0000">相同起始节点的连线具有相同的颜色</font>，确保达到你想要颜色分类的效果。同时对每条links添加title，鼠标悬停会显示相应内容。</p>
<h2 id="绘制节点数据nodes"><a href="#绘制节点数据nodes" class="headerlink" title="绘制节点数据nodes"></a>绘制节点数据nodes</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> node = svg.append(<span class="string">"g"</span>).selectAll(<span class="string">"g"</span>)</div><div class="line">                .data(energy.nodes)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"g"</span>)</div><div class="line">                .attr(<span class="string">'class'</span>, <span class="string">"node"</span>)</div><div class="line">                .attr(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                    <span class="keyword">return</span> <span class="string">"translate("</span> + d.x + <span class="string">","</span> + d.y + <span class="string">")"</span>;	<span class="comment">//节点的(x,y)坐标</span></div><div class="line">                &#125;);</div><div class="line"></div><div class="line">node.append(<span class="string">"rect"</span>)</div><div class="line">    .attr(<span class="string">"height"</span>,sankey.nodeWidth())</div><div class="line">    .attr(<span class="string">"width"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.dy; &#125;)</div><div class="line">    .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> d.color = color(d.name.replace(<span class="regexp">/ .*/</span>, <span class="string">""</span>));</div><div class="line">    &#125;)</div><div class="line">    .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> d3.rgb(d.color).darker(<span class="number">2</span>);</div><div class="line">    &#125;)</div><div class="line">    .append(<span class="string">"title"</span>)</div><div class="line">    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> d.name + <span class="string">"\n"</span> + format(d.value) ;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">node.append(<span class="string">"text"</span>)</div><div class="line">    .attr(<span class="string">"text-anchor"</span>,<span class="string">"middle"</span>)</div><div class="line">    .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> d.dy/<span class="number">2</span>;</div><div class="line">    &#125;)</div><div class="line">    .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        sankey.nodeWidth() / <span class="number">2</span>;</div><div class="line">    &#125;)</div><div class="line">    .attr(<span class="string">"dy"</span>,<span class="string">"1em"</span>)</div><div class="line">    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.name; &#125;)</div><div class="line">    .filter(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> d.x &lt; width / <span class="number">2</span> ;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>每个<code>rect</code>元素的高度(height)相同，宽度(width)为相应的dy；<code>stroke</code>把外框颜色设置成与<code>rect</code>元素同样的颜色并加深，图片放大可以明显的看出效果），<code>.text</code>添加鼠标悬停显示相应文字，效果如下：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-68c465a079894385.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/124"></p>
<h2 id="添加交互效果"><a href="#添加交互效果" class="headerlink" title="添加交互效果"></a>添加交互效果</h2><p>1.用CSS控制悬浮样式，让连接线在鼠标悬停的时候高亮显示：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> &gt;</span><span class="css"></span></div><div class="line">    <span class="selector-class">.link</span><span class="selector-pseudo">:hover</span> &#123;</div><div class="line">      <span class="attribute">stroke-opacity</span>: .<span class="number">8</span>;</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2.节点添加拖动事件</p>
<ul>
<li><p>定义一个拖动事件，这里仅限于水平方向的移动，移动之后重新布局并生成行的路径</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragmove</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">    d3.select(<span class="keyword">this</span>)</div><div class="line">    	.attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + (d.x = <span class="built_in">Math</span>.max(<span class="number">0</span>,<span class="built_in">Math</span>.min(width - d.dy, d3.event.x))) + <span class="string">","</span> + d.y + <span class="string">")"</span>) ;</div><div class="line"></div><div class="line">    sankey.relayout();	<span class="comment">// 重新布局</span></div><div class="line">    link.attr(<span class="string">"d"</span>,path);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>对node节点添加事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">node.call(d3.behavior.drag()	<span class="comment">//这一段只知道大概是什么意思</span></div><div class="line">        .origin(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> d;</div><div class="line">        &#125;)</div><div class="line">        .on(<span class="string">"dragstart"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">this</span>.parentNode.appendChild(<span class="keyword">this</span>);</div><div class="line">        &#125;)</div><div class="line">        .on(<span class="string">"drag"</span>,dragmove)</div><div class="line">	);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>好了，现在我们就可以做出首页第一张sankey图的效果了，最后再附上自己做的另一张横版sankey图（好像是由于sankey.js插件的问题，导致横竖排版）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-981bbacf1512a989.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<h2 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/d3.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/d3-sankey-1.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">style</span> &gt;</span><span class="css"></span></div><div class="line">            <span class="selector-tag">body</span> &#123;</div><div class="line">                <span class="attribute">background-color</span>: white;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-id">#chart</span> &#123;</div><div class="line">              <span class="attribute">height</span>: <span class="number">650px</span>; <span class="comment">/* must at least match the svg, to place content after it!*/</span></div><div class="line">            &#125;</div><div class="line">            <span class="selector-class">.node</span> <span class="selector-tag">rect</span> &#123;</div><div class="line">              <span class="attribute">cursor</span>: move;</div><div class="line">              <span class="attribute">fill-opacity</span>: .<span class="number">9</span>;</div><div class="line">              <span class="attribute">shape-rendering</span>: crispEdges;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-class">.node</span> <span class="selector-tag">text</span> &#123;</div><div class="line">              <span class="attribute">pointer-events</span>: none;</div><div class="line">              <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">#fff</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-class">.link</span> &#123;</div><div class="line">              <span class="attribute">fill</span>: none;</div><div class="line">              <span class="comment">/*stroke: #000;*/</span></div><div class="line">              <span class="attribute">stroke-opacity</span>: .<span class="number">5</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-class">.link</span><span class="selector-pseudo">:hover</span> &#123;</div><div class="line">              <span class="attribute">stroke-opacity</span>: .<span class="number">8</span>;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"chart"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> margin = &#123;<span class="attr">top</span>: <span class="number">1</span>, <span class="attr">right</span>: <span class="number">1</span>, <span class="attr">bottom</span>: <span class="number">6</span>, <span class="attr">left</span>: <span class="number">1</span>&#125;,</div><div class="line">                width = <span class="number">1000</span> - margin.left - margin.right,</div><div class="line">                height = <span class="number">650</span> - margin.top - margin.bottom;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> formatNumber = d3.format(<span class="string">",.0f"</span>),   <span class="comment">// 数字转字符串 逗号分隔，0位小数点</span></div><div class="line">                format = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;<span class="keyword">return</span> formatNumber(d) + <span class="string">"m CHF"</span>;&#125;;</div><div class="line">            <span class="keyword">var</span> color = d3.scale.category20();</div><div class="line"></div><div class="line">            <span class="keyword">var</span> svg = d3.select(<span class="string">"#chart"</span>)<span class="comment">//ID选择器</span></div><div class="line">                        .append(<span class="string">"svg"</span>)</div><div class="line">                        .attr(<span class="string">"width"</span>, width + margin.left + margin.right)</div><div class="line">                        .attr(<span class="string">"height"</span>, height + margin.top + margin.bottom)</div><div class="line">                        .append(<span class="string">"g"</span>)</div><div class="line">                        .attr(<span class="string">"transform"</span>, <span class="string">"translate("</span> + margin.left + <span class="string">","</span> + margin.top + <span class="string">")"</span>)</div><div class="line">                        ;</div><div class="line">            <span class="comment">// 布局</span></div><div class="line">            <span class="keyword">var</span> sankey = d3.sankey()</div><div class="line">                            .nodeWidth(<span class="number">25</span>)  <span class="comment">// 节点宽度</span></div><div class="line">                            .nodePadding(<span class="number">20</span>)    <span class="comment">// 矩形垂直方向的间距</span></div><div class="line">                            .size([width,height])</div><div class="line">                            <span class="comment">// .nodes(data.nodes)</span></div><div class="line">                            <span class="comment">// .links(data.links)</span></div><div class="line">                            <span class="comment">// .layout(3)</span></div><div class="line">                            ;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> path = sankey.link();</div><div class="line">            <span class="built_in">console</span>.log(path);</div><div class="line"></div><div class="line">            d3.json(<span class="string">"http://benlogan1981.github.io/VerticalSankey/data/ubs.json"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, energy</span>) </span>&#123;</div><div class="line">                sankey</div><div class="line">                    .nodes(energy.nodes)</div><div class="line">                    .links(energy.links)</div><div class="line">                    .layout(<span class="number">32</span>);</div><div class="line"></div><div class="line">                <span class="keyword">var</span> link = svg.append(<span class="string">"g"</span>).selectAll(<span class="string">"path"</span>)</div><div class="line">                                .data(energy.links)</div><div class="line">                                .enter()</div><div class="line">                                .append(<span class="string">"path"</span>)</div><div class="line">                                .attr(<span class="string">"class"</span>,<span class="string">"link"</span>)</div><div class="line">                                .attr(<span class="string">"d"</span>,path) <span class="comment">// 路径链接已被sankey封装好</span></div><div class="line">                                .style(<span class="string">"stroke-width"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                                    <span class="keyword">return</span> <span class="built_in">Math</span>.max(<span class="number">1</span>,d.dy);</div><div class="line">                                &#125;)</div><div class="line">                                <span class="comment">// .style("stroke",function(d) &#123;</span></div><div class="line">                                <span class="comment">//     console.log(d.source.name.replace(/ .*/,""));</span></div><div class="line">                                <span class="comment">// &#125;)</span></div><div class="line">                                .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                                    <span class="keyword">return</span> d.source.color = color(d.source.name.replace(<span class="regexp">/ .*/</span>,<span class="string">""</span>));</div><div class="line">                                &#125;)</div><div class="line">                                .sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">                                    <span class="keyword">return</span> b.dy - a.dy;</div><div class="line">                                &#125;)</div><div class="line">                                ;</div><div class="line"></div><div class="line">                link.append(<span class="string">"title"</span>)</div><div class="line">                    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                        <span class="keyword">return</span> d.source.name + <span class="string">"-&gt;"</span> + d.target.name + <span class="string">"\n"</span> + format(d.value) ;</div><div class="line">                    &#125;);</div><div class="line"></div><div class="line">                <span class="keyword">var</span> node = svg.append(<span class="string">"g"</span>).selectAll(<span class="string">"g"</span>)</div><div class="line">                                .data(energy.nodes)</div><div class="line">                                .enter()</div><div class="line">                                .append(<span class="string">"g"</span>)</div><div class="line">                                .attr(<span class="string">'class'</span>, <span class="string">"node"</span>)</div><div class="line">                                .attr(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                                    <span class="keyword">return</span> <span class="string">"translate("</span> + d.x + <span class="string">","</span> + d.y + <span class="string">")"</span>;</div><div class="line">                                &#125;)</div><div class="line">                                .call(d3.behavior.drag()</div><div class="line">                                        .origin(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                                            <span class="keyword">return</span> d;</div><div class="line">                                        &#125;)</div><div class="line">                                        .on(<span class="string">"dragstart"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                                            <span class="keyword">this</span>.parentNode.appendChild(<span class="keyword">this</span>);</div><div class="line">                                        &#125;)</div><div class="line">                                        .on(<span class="string">"drag"</span>,dragmove)</div><div class="line">                                )</div><div class="line">                                ;</div><div class="line"></div><div class="line">                node.append(<span class="string">"rect"</span>)</div><div class="line">                    .attr(<span class="string">"height"</span>,sankey.nodeWidth())</div><div class="line">                    .attr(<span class="string">"width"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.dy; &#125;)</div><div class="line">                    .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        <span class="keyword">return</span> d.color = color(d.name.replace(<span class="regexp">/ .*/</span>, <span class="string">""</span>));</div><div class="line">                    &#125;)</div><div class="line">                    .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        <span class="keyword">return</span> d3.rgb(d.color).darker(<span class="number">2</span>);</div><div class="line">                    &#125;)</div><div class="line">                    .append(<span class="string">"title"</span>)</div><div class="line">                    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        <span class="keyword">return</span> d.name + <span class="string">"\n"</span> + format(d.value) ;</div><div class="line">                    &#125;)</div><div class="line">                    ;</div><div class="line"></div><div class="line">                node.append(<span class="string">"text"</span>)</div><div class="line">                    .attr(<span class="string">"text-anchor"</span>,<span class="string">"middle"</span>)</div><div class="line">                    .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        <span class="keyword">return</span> d.dy/<span class="number">2</span>;</div><div class="line">                    &#125;)</div><div class="line">                    .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        sankey.nodeWidth() / <span class="number">2</span>;</div><div class="line">                    &#125;)</div><div class="line">                    .attr(<span class="string">"dy"</span>,<span class="string">"1em"</span>)</div><div class="line">                    .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.name; &#125;)</div><div class="line">                    .filter(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                        <span class="keyword">return</span> d.x &lt; width / <span class="number">2</span> ;</div><div class="line">                    &#125;)</div><div class="line">                    ;</div><div class="line"></div><div class="line">                <span class="function"><span class="keyword">function</span> <span class="title">dragmove</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    d3.select(<span class="keyword">this</span>).attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + (d.x = <span class="built_in">Math</span>.max(<span class="number">0</span>,<span class="built_in">Math</span>.min(width - d.dy, d3.event.x))) + <span class="string">","</span> + d.y + <span class="string">")"</span>) ;</div><div class="line">                    sankey.relayout();</div><div class="line">                    link.attr(<span class="string">"d"</span>,path);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="「参考资料」"><a href="#「参考资料」" class="headerlink" title="「参考资料」"></a>「参考资料」</h1><blockquote>
<p><a href="https://leanpub.com/d3-t-and-t-v4/read#leanpub-auto-sankey-diagrams" target="_blank" rel="external">【D3 Tips and Tricks v4.x】</a><br><a href="http://blog.csdn.net/tianxuzhang/article/details/49624701" target="_blank" rel="external">【D3.js数据可视化实战】–（3）桑基图（sankey）的绘制</a><br><a href="http://benlogan1981.github.io/VerticalSankey/UBS.html" target="_blank" rel="external">【USB 2015 Q1 Results】</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> D3.js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 数据可视化 </tag>
            
            <tag> D3.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[《大数据与机器学习》读书笔记（二） 应用篇]]></title>
      <url>JuniorNi.github.io/2017/04/07/%E3%80%8A%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89-%E5%BA%94%E7%94%A8%E7%AF%87/</url>
      <content type="html"><![CDATA[<h1 id="标签系统-“空间换时间”"><a href="#标签系统-“空间换时间”" class="headerlink" title="标签系统 - “空间换时间”"></a>标签系统 - “空间换时间”</h1><h2 id="作用与意义"><a href="#作用与意义" class="headerlink" title="作用与意义"></a>作用与意义</h2><ul>
<li>避免重复计算，提高查询效率</li>
<li>降低数据使用成本</li>
</ul>
<h2 id="层次结构"><a href="#层次结构" class="headerlink" title="层次结构"></a>层次结构</h2><p>整个标签系统可分为多个主题（信用卡系统中的客户主题、卡片主题等），每个主题下又可根据标签数据的来源分为三类（基础类、行为类与衍生类）</p>
<ul>
<li>基础类：如客户的基本信息，无需二次加工</li>
<li>行为类：如客户的历史行为（近一个月投资金额等），需要二次加工</li>
<li>衍生类：其他标签之间的逻辑组合</li>
</ul>
<a id="more"></a>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-611126ba88fb40d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="更新规则"><a href="#更新规则" class="headerlink" title="更新规则"></a>更新规则</h2><ul>
<li>基础类：静态标签，使用增量更新方式</li>
<li>行为类：动态标签，可采用周期性全量更新</li>
<li>衍生类：<font color="#FF0000">不存储标签值，仅存储标签之间的计算逻辑</font> ，无需更新</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-d7e7dd33fd483a17.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p><br></p>

<h1 id="数据自助营销平台-数据产生价值最直接的途径"><a href="#数据自助营销平台-数据产生价值最直接的途径" class="headerlink" title="数据自助营销平台 - 数据产生价值最直接的途径"></a>数据自助营销平台 - 数据产生价值最直接的途径</h1><h2 id="作用与意义-1"><a href="#作用与意义-1" class="headerlink" title="作用与意义"></a>作用与意义</h2><ul>
<li>自动化，提升工作效率</li>
<li>降低营销成本，提高用户体验</li>
<li>个性化营销，提升响应率<blockquote>
<p>e.g. 某一营销活动（为促动低消费频次的客户用卡，提高卡均消费金额），期望不同的客户收到不同的营销短信。可通过营销平台限定仅6个月用卡次数 &lt; 10，月消费1800满3个月（略高于历史上的月均卡均消费），即可获得免费的化妆品（偏好标签）。</p>
</blockquote>
</li>
<li>统一管理，便于后续效果追踪</li>
</ul>
<p>其中可以看到，各种营销活动规则下的条件来源于标签系统，所以<strong>标签系统</strong>是基础！</p>
<h2 id="实时数据营销"><a href="#实时数据营销" class="headerlink" title="实时数据营销"></a>实时数据营销</h2><p>除了传统的批量营销方式（如优惠券即将过期短信提醒等），还有一种<u><em>“基于场景的营销”</em></u>，如你到加油站加油，刷卡付款后会立马收到某汽车润滑剂的促销信息。</p>
<p>从技术上来看，就是引入“消息队列”（Kafka、ActiveMQ等），将用户基于场景的“动作”转化为一个“消息” 给到数据营销平台，根据匹配的营销规则进行实时处理，反馈结果给客户。</p>
<!-- <font color="#FF0000">asd as  </font>  -->]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[D3学习系列（二） 弦图绘制]]></title>
      <url>JuniorNi.github.io/2017/03/31/D3%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89-%E5%BC%A6%E5%9B%BE%E7%BB%98%E5%88%B6/</url>
      <content type="html"><![CDATA[<h1 id="「什么时候用弦图」"><a href="#「什么时候用弦图」" class="headerlink" title="「什么时候用弦图」"></a>「什么时候用弦图」</h1><p>Chord Diagram主要是用来表示多个节点之间的关系，假设我们要表示5个节点之间的关系，那么输入的矩阵是下面这个样子，且必须是方阵。节点A的长度是元素A所在行的总和，就是(A, A)、(A, B)、(A, C)、(A, D)、(A, E)的和。图中C与D之间的弦表示C和D相关，与C相接的弧长实际上是(C, D)的值。</p>
<a id="more"></a>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-928a0f7d64bcf0ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<h1 id="「绘制弦图」"><a href="#「绘制弦图」" class="headerlink" title="「绘制弦图」"></a>「绘制弦图」</h1><h2 id="导入初始数据"><a href="#导入初始数据" class="headerlink" title="导入初始数据"></a>导入初始数据</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> city_name = [ <span class="string">"北京"</span> , <span class="string">"上海"</span> , <span class="string">"广州"</span> , <span class="string">"深圳"</span> , <span class="string">"香港"</span>  ];</div><div class="line"><span class="keyword">var</span> population = [</div><div class="line">          [ <span class="number">1000</span>,  <span class="number">3045</span> , <span class="number">4567</span> , <span class="number">1234</span> , <span class="number">3714</span> ],</div><div class="line">          [ <span class="number">3214</span>,  <span class="number">2000</span> , <span class="number">2060</span> , <span class="number">124</span>  , <span class="number">3234</span> ],</div><div class="line">          [ <span class="number">8761</span>,  <span class="number">6545</span> , <span class="number">3000</span> , <span class="number">8045</span> , <span class="number">647</span>  ],</div><div class="line">          [ <span class="number">3211</span>,  <span class="number">1067</span> , <span class="number">3214</span> , <span class="number">4000</span> , <span class="number">1006</span> ],</div><div class="line">          [ <span class="number">2146</span>,  <span class="number">1034</span> , <span class="number">6745</span> , <span class="number">4764</span> , <span class="number">5000</span> ]</div><div class="line">        ];</div></pre></td></tr></table></figure>
<h2 id="布局（转换数据）"><a href="#布局（转换数据）" class="headerlink" title="布局（转换数据）"></a>布局（转换数据）</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 弦布局</span></div><div class="line"><span class="keyword">var</span> chord_layout = d3.layout.chord()</div><div class="line">                        .padding(<span class="number">0.03</span>)</div><div class="line">                        .sortSubgroups(d3.descending)</div><div class="line">                        .matrix(population);</div><div class="line"><span class="comment">// 布局转化数据</span></div><div class="line"><span class="keyword">var</span> groups = chord_layout.groups();</div><div class="line"><span class="keyword">var</span> chords = chord_layout.chords();</div></pre></td></tr></table></figure>
<p>padding(0.03)表示弧与弧之间的间隔，population是之前输入的人口数据。经过布局之后会生成两块，一块是groups，表示节点；另一块是chords，表示弦（连线），chords里面还会分source与target，表示连线的两端。</p>
<h2 id="绘制画布SVG"><a href="#绘制画布SVG" class="headerlink" title="绘制画布SVG"></a>绘制画布SVG</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// svg画布</span></div><div class="line"><span class="keyword">var</span> width = <span class="number">600</span>;</div><div class="line"><span class="keyword">var</span> height = <span class="number">600</span>;</div><div class="line"><span class="keyword">var</span> svg = d3.select(<span class="string">"body"</span>)</div><div class="line">            .append(<span class="string">"svg"</span>)</div><div class="line">            .attr(<span class="string">"width"</span>,width)</div><div class="line">            .attr(<span class="string">'height'</span>, height)</div><div class="line">            .append(<span class="string">"g"</span>)</div><div class="line">            .attr(<span class="string">'transform'</span>, <span class="string">'translate('</span> + width/<span class="number">2</span> + <span class="string">","</span> + height/<span class="number">2</span> + <span class="string">")"</span>);</div><div class="line"><span class="keyword">var</span> color20 = d3.scale.category20();</div></pre></td></tr></table></figure>
<p>先创建一个<code>SVG</code>元素，里面添加一个<code>g</code>元素同时设置平移属性（用来确定弦图的中心）。然后再在<code>g</code>元素添加2个<code>g</code>元素，分别用来装节点与弦，结构如下所示：</p>
<blockquote>
<p><code>&lt;svg&gt;</code><br>　－－<code>&lt;g&gt;</code><br>　－－－－ <code>&lt;g&gt;``&lt;/g&gt;</code><br>　－－－－ <code>&lt;g&gt;``&lt;/g&gt;</code><br>　－－<code>&lt;/g&gt;</code><br><code>&lt;/svg&gt;</code> </p>
</blockquote>
<h2 id="绘制节点（弧）"><a href="#绘制节点（弧）" class="headerlink" title="绘制节点（弧）"></a>绘制节点（弧）</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 弧生成器</span></div><div class="line"><span class="keyword">var</span> innerRadius = width/<span class="number">2</span> * <span class="number">0.7</span>;</div><div class="line"><span class="keyword">var</span> outerRadius = innerRadius * <span class="number">1.1</span>;</div><div class="line"><span class="keyword">var</span> outer_arc = d3.svg.arc()</div><div class="line">                    .innerRadius(innerRadius)</div><div class="line">                    .outerRadius(outerRadius);</div><div class="line"><span class="comment">// 绘制节点</span></div><div class="line"><span class="keyword">var</span> g_outer = svg.append(<span class="string">"g"</span>);</div><div class="line">g_outer.selectAll(<span class="string">"path"</span>)</div><div class="line">        .data(groups)</div><div class="line">        .enter()</div><div class="line">        .append(<span class="string">"path"</span>)</div><div class="line">        .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> color20(d.index);</div><div class="line">        &#125;)</div><div class="line">        .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">            color20(d.index);</div><div class="line">        &#125;)</div><div class="line">        .attr(<span class="string">"d"</span>,outer_arc)   <span class="comment">// 此处调用了弧生成器</span></div><div class="line">        ;</div><div class="line"><span class="comment">// 节点文字</span></div><div class="line">g_outer.selectAll(<span class="string">"text"</span>)</div><div class="line">        .data(groups)</div><div class="line">        .enter()</div><div class="line">        .append(<span class="string">"text"</span>)</div><div class="line">        .each(<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>) </span>&#123;   <span class="comment">// 对每个绑定的数据添加两个变量</span></div><div class="line">            d.angle = (d.startAngle +　d.endAngle) / <span class="number">2</span>;</div><div class="line">            d.name = city_name[i];</div><div class="line">        &#125;)</div><div class="line">        .attr(<span class="string">"dy"</span>,<span class="string">".35em"</span>)</div><div class="line">        .attr(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;    <span class="comment">// 平移属性</span></div><div class="line">            <span class="keyword">var</span> result =  <span class="string">"rotate("</span> +　(d.angle*<span class="number">180</span>/<span class="built_in">Math</span>.PI) + <span class="string">")"</span>;</div><div class="line">            result += <span class="string">"translate(0,"</span> + <span class="number">-1</span> * (outerRadius + <span class="number">10</span>) + <span class="string">")"</span>;</div><div class="line">            <span class="keyword">if</span> (d.angle &gt; <span class="built_in">Math</span>.PI * <span class="number">3</span> / <span class="number">4</span> &amp;&amp; d.angle &lt; <span class="built_in">Math</span>.PI * <span class="number">5</span> / <span class="number">4</span> )</div><div class="line">                result += <span class="string">"rotate(180)"</span>;</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        &#125;)</div><div class="line">        .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> d.name;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<p>在标记文字的地方要注意：</p>
<ol>
<li>each()：表示对任何一个绑定数据的元素，都执行后面的无名函数 function(d,i) ，计算文字的角度与内容</li>
<li>transform()：不仅需要考虑文字的旋转角度与平移距离，还要考虑如果文字在下方是会是倒写的情况。</li>
</ol>
<p>生成如下图：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-7585d7f93ebecf84.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="绘制连线（弦）"><a href="#绘制连线（弦）" class="headerlink" title="绘制连线（弦）"></a>绘制连线（弦）</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 弦生成器</span></div><div class="line"><span class="keyword">var</span> inner_chord = d3.svg.chord()</div><div class="line">                        .radius(innerRadius);</div><div class="line"></div><div class="line"><span class="comment">// 绘制内部弦</span></div><div class="line"><span class="keyword">var</span> g_inner = svg.append(<span class="string">"g"</span>)</div><div class="line">                .attr(<span class="string">"class"</span>,<span class="string">"chord"</span>);</div><div class="line"></div><div class="line">g_inner.selectAll(<span class="string">"path"</span>)</div><div class="line">        .data(chords)</div><div class="line">        .enter()</div><div class="line">        .append(<span class="string">"path"</span>)</div><div class="line">        .attr(<span class="string">"d"</span>,inner_chord)  <span class="comment">// 调用弦的路径值</span></div><div class="line">        .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> color20(d.source.index);</div><div class="line">        &#125;)</div><div class="line">        .style(<span class="string">"opacity"</span>,<span class="number">1</span>)</div><div class="line">        ;</div></pre></td></tr></table></figure>
<p>这样就生成了首页的弦图，但是当数据多了之后，会看不清节点与节点之间的关系，我们可以添加一些交互式的操作解决。如当鼠标移到该节点，只会显示与该节点相接的弦，其他的会被隐藏。这里我们定义一个fade函数，并在节点（弧）上通过<code>mouseover</code>与<code>mouseout</code>添加动作<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fade</span>(<span class="params">opacity</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">g,i</span>)</span>&#123;</div><div class="line">        g_inner.selectAll(<span class="string">"path"</span>)</div><div class="line">                .filter(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    <span class="keyword">return</span> d.source.index != i &amp;&amp; d.target.index != i;</div><div class="line">                &#125;)</div><div class="line">                .transition()</div><div class="line">                .style(<span class="string">"opacity"</span>,opacity);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">g_outer.selectAll(<span class="string">"path"</span>)</div><div class="line">        .on(<span class="string">"mouseover"</span>,fade(<span class="number">0.0</span>))  <span class="comment">// 0.0完全透明</span></div><div class="line">        .on(<span class="string">"mouseout"</span>,fade(<span class="number">1.0</span>))   <span class="comment">// 1.0完全不透明</span></div><div class="line">        ;</div></pre></td></tr></table></figure></p>
<p>效果如图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-c05549c04d8b0c4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="「源代码」"><a href="#「源代码」" class="headerlink" title="「源代码」"></a>「源代码」</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://d3js.org/d3.v3.min.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">            <span class="selector-class">.chord</span> <span class="selector-tag">path</span>&#123;</div><div class="line">                <span class="attribute">fill-opacity</span>: <span class="number">0.67</span>;</div><div class="line">                <span class="attribute">stroke</span>: <span class="number">#000</span>;</div><div class="line">                <span class="attribute">stroke-width</span>: <span class="number">0.5px</span>;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">        <span class="comment">// 初始数据</span></div><div class="line">        <span class="keyword">var</span> city_name = [ <span class="string">"北京"</span> , <span class="string">"上海"</span> , <span class="string">"广州"</span> , <span class="string">"深圳"</span> , <span class="string">"香港"</span>  ];</div><div class="line">        <span class="keyword">var</span> population = [</div><div class="line">                  [ <span class="number">1000</span>,  <span class="number">3045</span> , <span class="number">4567</span> , <span class="number">1234</span> , <span class="number">3714</span> ],</div><div class="line">                  [ <span class="number">3214</span>,  <span class="number">2000</span> , <span class="number">2060</span> , <span class="number">124</span>  , <span class="number">3234</span> ],</div><div class="line">                  [ <span class="number">8761</span>,  <span class="number">6545</span> , <span class="number">3000</span> , <span class="number">8045</span> , <span class="number">647</span>  ],</div><div class="line">                  [ <span class="number">3211</span>,  <span class="number">1067</span> , <span class="number">3214</span> , <span class="number">4000</span> , <span class="number">1006</span> ],</div><div class="line">                  [ <span class="number">2146</span>,  <span class="number">1034</span> , <span class="number">6745</span> , <span class="number">4764</span> , <span class="number">5000</span> ]</div><div class="line">                ];</div><div class="line"></div><div class="line">        <span class="comment">// 弦布局</span></div><div class="line">        <span class="keyword">var</span> chord_layout = d3.layout.chord()</div><div class="line">                                .padding(<span class="number">0.03</span>)</div><div class="line">                                .sortSubgroups(d3.descending)</div><div class="line">                                .matrix(population);</div><div class="line"></div><div class="line">        <span class="comment">// 布局转化数据</span></div><div class="line">        <span class="keyword">var</span> groups = chord_layout.groups();</div><div class="line">        <span class="keyword">var</span> chords = chord_layout.chords();</div><div class="line">        <span class="built_in">console</span>.log(groups);</div><div class="line">        <span class="built_in">console</span>.log(chords);</div><div class="line"></div><div class="line">        <span class="comment">// svg画布</span></div><div class="line">        <span class="keyword">var</span> width = <span class="number">600</span>;</div><div class="line">        <span class="keyword">var</span> height = <span class="number">600</span>;</div><div class="line">        <span class="keyword">var</span> svg = d3.select(<span class="string">"body"</span>)</div><div class="line">                    .append(<span class="string">"svg"</span>)</div><div class="line">                    .attr(<span class="string">"width"</span>,width)</div><div class="line">                    .attr(<span class="string">'height'</span>, height)</div><div class="line">                    .append(<span class="string">"g"</span>)</div><div class="line">                    .attr(<span class="string">'transform'</span>, <span class="string">'translate('</span> + width/<span class="number">2</span> + <span class="string">","</span> + height/<span class="number">2</span> + <span class="string">")"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> color20 = d3.scale.category20();</div><div class="line"></div><div class="line">        <span class="comment">// 弧生成器</span></div><div class="line">        <span class="keyword">var</span> innerRadius = width/<span class="number">2</span> * <span class="number">0.7</span>;</div><div class="line">        <span class="keyword">var</span> outerRadius = innerRadius * <span class="number">1.1</span>;</div><div class="line">        <span class="keyword">var</span> outer_arc = d3.svg.arc()</div><div class="line">                            .innerRadius(innerRadius)</div><div class="line">                            .outerRadius(outerRadius);</div><div class="line"></div><div class="line">        <span class="comment">// 绘制节点</span></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">fade</span>(<span class="params">opacity</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">g,i</span>)</span>&#123;</div><div class="line">                g_inner.selectAll(<span class="string">"path"</span>)</div><div class="line">                        .filter(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                            <span class="keyword">return</span> d.source.index != i &amp;&amp; d.target.index != i;</div><div class="line">                        &#125;)</div><div class="line">                        .transition()</div><div class="line">                        .style(<span class="string">"opacity"</span>,opacity);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">var</span> g_outer = svg.append(<span class="string">"g"</span>);</div><div class="line">        g_outer.selectAll(<span class="string">"path"</span>)</div><div class="line">                .data(groups)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"path"</span>)</div><div class="line">                .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    <span class="keyword">return</span> color20(d.index);</div><div class="line">                &#125;)</div><div class="line">                .style(<span class="string">"stroke"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    color20(d.index);</div><div class="line">                &#125;)</div><div class="line">                .attr(<span class="string">"d"</span>,outer_arc)   <span class="comment">// 此处调用了弧生成器</span></div><div class="line">                .on(<span class="string">"mouseover"</span>,fade(<span class="number">0.0</span>))  <span class="comment">// 0.0完全透明</span></div><div class="line">                .on(<span class="string">"mouseout"</span>,fade(<span class="number">1.0</span>))   <span class="comment">// 1.0完全不透明</span></div><div class="line">                ;</div><div class="line"></div><div class="line">        g_outer.selectAll(<span class="string">"text"</span>)</div><div class="line">                .data(groups)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"text"</span>)</div><div class="line">                .each(<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>) </span>&#123;   <span class="comment">// 对每个绑定的数据添加两个变量</span></div><div class="line">                    d.angle = (d.startAngle +　d.endAngle) / <span class="number">2</span>;</div><div class="line">                    d.name = city_name[i];</div><div class="line">                &#125;)</div><div class="line">                .attr(<span class="string">"dy"</span>,<span class="string">".35em"</span>)</div><div class="line">                .attr(<span class="string">'transform'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;    <span class="comment">// 平移属性</span></div><div class="line">                    <span class="keyword">var</span> result =  <span class="string">"rotate("</span> +　(d.angle*<span class="number">180</span>/<span class="built_in">Math</span>.PI) + <span class="string">")"</span>;</div><div class="line">                    result += <span class="string">"translate(0,"</span> + <span class="number">-1</span> * (outerRadius + <span class="number">10</span>) + <span class="string">")"</span>;</div><div class="line">                    <span class="keyword">if</span> (d.angle &gt; <span class="built_in">Math</span>.PI * <span class="number">3</span> / <span class="number">4</span> &amp;&amp; d.angle &lt; <span class="built_in">Math</span>.PI * <span class="number">5</span> / <span class="number">4</span> )</div><div class="line">                        result += <span class="string">"rotate(180)"</span>;</div><div class="line">                    <span class="keyword">return</span> result;</div><div class="line">                &#125;)</div><div class="line">                .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    <span class="keyword">return</span> d.name;</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">        <span class="comment">// 弦生成器</span></div><div class="line">        <span class="keyword">var</span> inner_chord = d3.svg.chord()</div><div class="line">                                .radius(innerRadius);</div><div class="line"></div><div class="line">        <span class="comment">// 绘制内部弦,一共有5*5=25条</span></div><div class="line">        <span class="keyword">var</span> g_inner = svg.append(<span class="string">"g"</span>)</div><div class="line">                        .attr(<span class="string">"class"</span>,<span class="string">"chord"</span>);</div><div class="line"></div><div class="line">        g_inner.selectAll(<span class="string">"path"</span>)</div><div class="line">                .data(chords)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"path"</span>)</div><div class="line">                .attr(<span class="string">"d"</span>,inner_chord)  <span class="comment">// 调用弦的路径值</span></div><div class="line">                .style(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">                    <span class="keyword">return</span> color20(d.source.index);</div><div class="line">                &#125;)</div><div class="line">                .style(<span class="string">"opacity"</span>,<span class="number">1</span>)</div><div class="line">                ;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> D3.js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 数据可视化 </tag>
            
            <tag> D3.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[D3学习系列（一） 基础知识与柱形图绘制]]></title>
      <url>JuniorNi.github.io/2017/03/25/D3%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%8E%E6%9F%B1%E5%BD%A2%E5%9B%BE%E7%BB%98%E5%88%B6/</url>
      <content type="html"><![CDATA[<h1 id="「前言」"><a href="#「前言」" class="headerlink" title="「前言」"></a>「前言」</h1><p>最开始的初衷是想画个弦图（chord）与桑基图（sankey），真的很炫有没有！然而D3零基础的我表示源码看不懂，受到1万点暴击(<em>+﹏+</em>)~  于是果断去恶补D3的基础知识，并加以整理同时加深对自己的印象。</p>
<a id="more"></a>
<h1 id="「基础概念」"><a href="#「基础概念」" class="headerlink" title="「基础概念」"></a>「基础概念」</h1><p><strong>选择集</strong><br>使用 d3.select() 或 d3.selectAll() 选择元素后返回的对象，就是选择集</p>
<p><strong>无名函数</strong><br>function(d, i) 这个函数以后经常要使用到</p>
<ul>
<li>d 代表数据，也就是与某元素绑定的数据。</li>
<li>i 代表索引，代表数据的索引号，从 0 开始。</li>
</ul>
<h1 id="「数据绑定」"><a href="#「数据绑定」" class="headerlink" title="「数据绑定」"></a>「数据绑定」</h1><p>D3可以用两种函数来绑定数据：</p>
<ul>
<li><strong>datum()：</strong> 绑定一个数据到选择集上，这里的数据并非一定要是number（数值型），也可以是string（字符串）、bollean（布尔型）和object（对象）</li>
<li><strong>data()：</strong> 绑定一个数组到选择集上，数组的各项值分别与选择集的各元素绑定，<strong>更常用</strong></li>
</ul>
<p>data() 函数的常用语法<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dataset = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span>];</div><div class="line"><span class="keyword">var</span> body = d3.select(<span class="string">"body"</span>);</div><div class="line"></div><div class="line">body.selectAll(<span class="string">"p"</span>)  <span class="comment">//选择body中的所有p，但是目前还没有，所以是空集</span></div><div class="line">	.data(dataset)  <span class="comment">//绑定数组</span></div><div class="line">	.enter()  <span class="comment">//指定选择集的enter部分</span></div><div class="line">	.append(<span class="string">"p"</span>)</div><div class="line">	.text(<span class="function"><span class="keyword">function</span><span class="params">(d)</span></span>&#123; </div><div class="line">		<span class="keyword">return</span> d; </div><div class="line">	&#125;)</div></pre></td></tr></table></figure></p>
<p>这里要解释下 Enter 的概念，它与Update、Exit是D3中三个非常重要的概念，处理的是当选择集和数据的数量关系不确定的情况。</p>
<p>如果数组为 [3, 6, 9, 12, 15]，将此数组绑定到三个 p 元素的选择集上。可以想象，会有两个数据没有元素与之对应，这时候 D3 会建立两个空的元素与数据对应，这一部分就称为 Enter。而有元素与数据对应的部分称为 Update。如果数组为 [3]，则会有两个元素没有数据绑定，那么没有数据绑定的部分被称为 Exit。示意图如下所示。<br><img src="http://upload-images.jianshu.io/upload_images/4762054-45174e72ed043a8a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="「柱形图」"><a href="#「柱形图」" class="headerlink" title="「柱形图」"></a>「柱形图」</h1><p><strong>Bar Chart一般包括：矩形、坐标轴与文字。</strong></p>
<h2 id="矩形"><a href="#矩形" class="headerlink" title="矩形"></a>矩形</h2><p>这里我们直接定义一个数组，用数组项对应矩形的长短（然而这种方法并不理想）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dataset = [<span class="number">50</span>, <span class="number">43</span>, <span class="number">120</span>, <span class="number">87</span>, <span class="number">99</span>, <span class="number">167</span>, <span class="number">142</span>];</div></pre></td></tr></table></figure></p>
<p>定义一块SVG的绘制区域：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> width = <span class="number">600</span>;	<span class="comment">// SVG的宽度</span></div><div class="line"><span class="keyword">var</span> height = <span class="number">600</span>;	<span class="comment">// SVG的长度</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> svg = d3.select(<span class="string">"body"</span>)</div><div class="line">            .append(<span class="string">'svg'</span>)	<span class="comment">// body中添加SVG</span></div><div class="line">            .attr(<span class="string">'width'</span>, width)</div><div class="line">            .attr(<span class="string">'height'</span>, height);</div></pre></td></tr></table></figure></p>
<p>定义三个我们要用的变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> padding = &#123;<span class="attr">top</span>: <span class="number">20</span>, <span class="attr">right</span>: <span class="number">20</span>, <span class="attr">bottom</span>: <span class="number">20</span>, <span class="attr">left</span>: <span class="number">20</span>&#125;;</div><div class="line"><span class="keyword">var</span> rectStep = <span class="number">35</span>;</div><div class="line"><span class="keyword">var</span> rectWidth = <span class="number">30</span>;</div></pre></td></tr></table></figure></p>
<p>padding是svg内的最外一层区域，留一段空白宽度是为了防止图形绘制带svg区域外。rectStep表示前一个矩形到下一个矩形的距离（包括空白间隔），而rectWidth是矩形实际的宽度。说了这么多还是看图更易懂：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-93e0f16104bc5545.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>添加矩形元素<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> rect = svg.selectAll(<span class="string">"rect"</span>)</div><div class="line">              .data(dataset)</div><div class="line">              .enter()  <span class="comment">//获取enter部分</span></div><div class="line">              .append(<span class="string">"rect"</span>)	<span class="comment">//添加rect元素，使其与绑定数组的长度一致</span></div><div class="line">              .attr(<span class="string">"fill"</span>,<span class="string">"steelblue"</span>)</div><div class="line">              .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	<span class="comment">//设置X坐标</span></div><div class="line">                  <span class="keyword">return</span> padding.left + i * rectStep;</div><div class="line">              &#125;)</div><div class="line">              .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	<span class="comment">//设置Y坐标</span></div><div class="line">                  <span class="keyword">return</span> height - padding.bottom - d;</div><div class="line">              &#125;)</div><div class="line">              .attr(<span class="string">"width"</span>,rectWidth)	<span class="comment">//设置矩形宽度，之前定义的</span></div><div class="line">              .attr(<span class="string">"height"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;	<span class="comment">//设置矩形高度，即为数组中的各项值</span></div><div class="line">                  <span class="keyword">return</span> d</div><div class="line">              &#125;);</div></pre></td></tr></table></figure></p>
<p>因为数组dataset的长度为7，所以最后生成7个矩形。x与y坐标是矩形的<strong>左上角顶点</strong>。 这个坐标是相对应svg绘图区域来讲的，坐标原点位于左上角(0,0)。</p>
<p>一张图直接说明：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-cf20c0197612b953.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="标签文字"><a href="#标签文字" class="headerlink" title="标签文字"></a>标签文字</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> text = svg.selectAll(text)</div><div class="line">                .data(dataset)</div><div class="line">                .enter()</div><div class="line">                .append(<span class="string">"text"</span>)</div><div class="line">                .attr(<span class="string">"fill"</span>,<span class="string">"white"</span>)</div><div class="line">                .attr(<span class="string">"font-size"</span>,<span class="string">"14px"</span>)</div><div class="line">                .attr(<span class="string">"text-anchor"</span>,<span class="string">"middle"</span>)</div><div class="line">                .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	<span class="comment">//与矩形的X坐标一样</span></div><div class="line">                    <span class="keyword">return</span> padding.left + i * rectStep;</div><div class="line">                &#125;)</div><div class="line">                .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">                    <span class="keyword">return</span> height - padding.bottom - d;</div><div class="line">                &#125;)</div><div class="line">                .attr(<span class="string">'dx'</span>, rectWidth/<span class="number">2</span>)	<span class="comment">//x轴相对平移距离</span></div><div class="line">                .attr(<span class="string">'dy'</span>, <span class="string">"1em"</span>)	<span class="comment">//em单位表示的是当前文字所占一行的高度</span></div><div class="line">                .text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;	<span class="comment">//要显示的文字内容</span></div><div class="line">                    <span class="keyword">return</span> d;	</div><div class="line">                &#125;);</div></pre></td></tr></table></figure>
<p>添加文字标签的方法与添加矩形元素方法相类似，不过颜色要与矩形的颜色区分。通过设置元素的text-anchor、x、y、dx与dy五个属性，让文字显示在每个矩形的<strong>正中心</strong>。</p>
<p>其中dx,dy表示相对(x,y)平移的大小，所以文本会从(x+dx,y+dy)位置开始显示，这个位置也叫<em><u>起始位置</u></em>。<br>属性text-anchor有三个值：start、middle、end,，这里用middle表示文字中心位于<em><u>起始位置</u></em>上。</p>
<p>还是上图说明问题：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-42d5fac07d1143e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>效果图：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-cb0e1d5c9e8233c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="坐标轴"><a href="#坐标轴" class="headerlink" title="坐标轴"></a>坐标轴</h2><p>坐标轴的主直线由path构成，刻度由line绘制，刻度文字用text完成。之前我们直接用数值的大小来表示像素的大小，这里我们使用<strong>比例尺</strong>，定义如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// SVG画布</span></div><div class="line"><span class="keyword">var</span> width = <span class="number">600</span>;</div><div class="line"><span class="keyword">var</span> height = <span class="number">600</span>;</div><div class="line"><span class="keyword">var</span> svg = d3.select(<span class="string">"body"</span>).append(<span class="string">'svg'</span>)</div><div class="line">            .attr(<span class="string">'width'</span>, width)</div><div class="line">            .attr(<span class="string">'height'</span>, height);</div><div class="line"></div><div class="line"><span class="comment">// 坐标轴的线性比例尺</span></div><div class="line"><span class="keyword">var</span> xScale = d3.scale.linear()</div><div class="line">                .domain([<span class="number">0</span>,<span class="number">10</span>])	<span class="comment">//定义域</span></div><div class="line">                .range([<span class="number">0</span>,<span class="number">300</span>]);	<span class="comment">//值域</span></div><div class="line"></div><div class="line"><span class="comment">// 定义坐标轴</span></div><div class="line"><span class="keyword">var</span> axis = d3.svg.axis()</div><div class="line">            .scale(xScale)</div><div class="line">            .orient(<span class="string">"bottom"</span>)</div><div class="line">            .ticks(<span class="number">5</span>);	<span class="comment">//刻度的数量，这里显示5个</span></div><div class="line"></div><div class="line"><span class="comment">//在 SVG 中添加一个分组元素，再将坐标轴的其他元素添加到里面</span></div><div class="line"><span class="keyword">var</span> gAxis = svg.append(<span class="string">"g"</span>)</div><div class="line">                .attr(<span class="string">"transform"</span>,<span class="string">"translate(80,80)"</span>);</div><div class="line">                .call(axis)</div><div class="line"></div><div class="line">gAxis.attr(<span class="string">'class'</span>, <span class="string">'axis'</span>);	<span class="comment">//添加一些样式，否则太太太丑了...</span></div></pre></td></tr></table></figure></p>
<p>call()函数的使用十分常见，这里使用的参数是前面定义的坐标轴axis，等价于<code>axis(gAxis);</code>的形式。效果图如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-638001ef464c5cf6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png">  </p>
<h1 id="「柱形图的坐标轴」"><a href="#「柱形图的坐标轴」" class="headerlink" title="「柱形图的坐标轴」"></a>「柱形图的坐标轴」</h1><p>对初学者而言，这里的坑更多（老司机请无视）。主要是因为使用了比例尺之后，XY坐标轴、矩形长宽、刻度都要与之相对应。<em>不要问我为什么知道这么多，都是泪……</em></p>
<p><strong>为矩形图定义比例尺</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xAxisWidth = <span class="number">300</span>;	<span class="comment">//x轴宽度</span></div><div class="line"><span class="keyword">var</span> yAxisWidth = <span class="number">300</span>;	<span class="comment">//y轴宽度</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> xScale = d3.scale.ordinal()	<span class="comment">//x轴比例尺（序数比例尺）</span></div><div class="line">                .domain(d3.range(dataset.length))</div><div class="line">                .rangeRoundBands([<span class="number">0</span>,xAxisWidth],<span class="number">0.2</span>);</div><div class="line"><span class="keyword">var</span> yScale = d3.scale.linear()	<span class="comment">//y轴比例尺（线性比例尺）</span></div><div class="line">                .domain([<span class="number">0</span>,d3.max(dataset)])</div><div class="line">                .range([<span class="number">0</span>,yAxisWidth]);</div></pre></td></tr></table></figure></p>
<p>定义完比例尺之后，矩形的高度、位置都要用比例尺来计算。如此之后，仅需简单修改比例尺，图表就能自动伸缩，所以前面的<em><u>矩形元素</u></em>与<em><u>矩形文字</u></em>的代码都需要修改</p>
<p><strong>矩形元素修改部分</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">.attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	</div><div class="line">    <span class="keyword">return</span> padding.left + xScale(i);	<span class="comment">// return padding.left + i * rectStep;</span></div><div class="line">&#125;)</div><div class="line">.attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	</div><div class="line">    <span class="keyword">return</span> height - padding.bottom - yScale(d);	<span class="comment">// return height - padding.bottom - d;</span></div><div class="line">&#125;)</div><div class="line">.attr(<span class="string">"width"</span>,xScale.rangeBand()) </div><div class="line">.attr(<span class="string">"height"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> yScale(d);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><strong>标签文字修改部分</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">.attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;	<span class="comment">//与矩形的X坐标一样</span></div><div class="line">    <span class="keyword">return</span> padding.left + xScale(i);</div><div class="line">&#125;)</div><div class="line">.attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> height - padding.bottom - yScale(d);</div><div class="line">&#125;)</div><div class="line">.attr(<span class="string">'dx'</span>, xScale.rangeBand()/<span class="number">2</span>)	<span class="comment">//x轴相对平移距离</span></div><div class="line">.attr(<span class="string">'dy'</span>, <span class="string">"1em"</span>)	<span class="comment">//em单位表示的是当前文字所占一行的高度</span></div><div class="line">.text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;	<span class="comment">//要显示的文字内容</span></div><div class="line">    <span class="keyword">return</span> d;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>定义坐标轴</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xAxis = d3.svg.axis()</div><div class="line">            .scale(xScale)</div><div class="line">            .orient(<span class="string">"bottom"</span>);</div><div class="line"></div><div class="line">yScale.range([yAxisWidth,<span class="number">0</span>]);	<span class="comment">//值域相反</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> yAxis = d3.svg.axis()</div><div class="line">            .scale(yScale)</div><div class="line">            .orient(<span class="string">"left"</span>);</div></pre></td></tr></table></figure></p>
<p>此外还要注意，y轴坐标的值域要与原来<strong>相反</strong>，从最大值到最小值，否则最后会出现下面这种情况：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-04b43eb28412b558.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 35px;"></p>
<p><strong>添加坐标轴元素</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//添加x轴</span></div><div class="line">svg.append(<span class="string">"g"</span>)	</div><div class="line">	.attr(<span class="string">"class"</span>,<span class="string">"axis"</span>)</div><div class="line">	.attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + padding.left + <span class="string">","</span> + (height - padding.bottom) + <span class="string">")"</span>)</div><div class="line">	.call(xAxis);</div><div class="line"></div><div class="line"><span class="comment">//添加y轴</span></div><div class="line">svg.append(<span class="string">"g"</span>)</div><div class="line">	.attr(<span class="string">"class"</span>,<span class="string">"axis"</span>)</div><div class="line">	.attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + padding.left + <span class="string">","</span> + (height - padding.bottom - yAxisWidth) + <span class="string">")"</span>)</div><div class="line">	.call(yAxis);</div></pre></td></tr></table></figure></p>
<p>这里要小心x轴、y轴平移到目标位置的距离，以及你设置padding前后左右的宽度，防止坐标轴跑到外面去（又是血与泪的教训）。</p>
<p>最后效果图：<br><img src="http://upload-images.jianshu.io/upload_images/4762054-6fbc5940b5a6d009.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>完整源代码</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://d3js.org/d3.v3.min.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">            <span class="selector-class">.axis</span> <span class="selector-tag">path</span>,</div><div class="line">            <span class="selector-class">.axis</span> <span class="selector-tag">line</span>&#123;</div><div class="line">                <span class="attribute">fill</span>: none;</div><div class="line">                <span class="attribute">stroke</span>: black;</div><div class="line">                <span class="attribute">shape-rendering</span>: crispEdges;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-class">.axis</span> <span class="selector-tag">text</span>&#123;</div><div class="line">                <span class="attribute">font-family</span>: sans-serif;</div><div class="line">                <span class="attribute">font-size</span>: <span class="number">11px</span>;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> &gt;</span><span class="actionscript"></span></div><div class="line">            <span class="comment">// 添加SVG画布</span></div><div class="line">            <span class="keyword">var</span> dataset = [<span class="number">50</span>, <span class="number">43</span>, <span class="number">120</span>, <span class="number">87</span>, <span class="number">99</span>, <span class="number">167</span>, <span class="number">142</span>];</div><div class="line">            <span class="keyword">var</span> width = <span class="number">600</span>;	<span class="comment">// SVG的宽度</span></div><div class="line">            <span class="keyword">var</span> height = <span class="number">600</span>;	<span class="comment">// SVG的长度</span></div><div class="line">            <span class="keyword">var</span> svg = d3.select(<span class="string">"body"</span>)</div><div class="line">                        .append(<span class="string">'svg'</span>)	<span class="comment">// body中添加SVG</span></div><div class="line">                        .attr(<span class="string">'width'</span>, width)</div><div class="line">                        .attr(<span class="string">'height'</span>, height);</div><div class="line">            <span class="keyword">var</span> padding = &#123;top: <span class="number">20</span>, right: <span class="number">20</span>, bottom: <span class="number">20</span>, left: <span class="number">30</span>&#125;;</div><div class="line"></div><div class="line">            <span class="comment">// 定义数据与比例尺</span></div><div class="line">            <span class="keyword">var</span> xAxisWidth = <span class="number">300</span>;	<span class="comment">//x轴宽度</span></div><div class="line">            <span class="keyword">var</span> yAxisWidth = <span class="number">300</span>;	<span class="comment">//y轴宽度</span></div><div class="line">            <span class="keyword">var</span> xScale = d3.scale.ordinal()	<span class="comment">//x轴比例尺（序数比例尺）</span></div><div class="line">                            .domain(d3.range(dataset.length))</div><div class="line">                            .rangeRoundBands([<span class="number">0</span>,xAxisWidth],<span class="number">0.2</span>);</div><div class="line">            <span class="keyword">var</span> yScale = d3.scale.linear()	<span class="comment">//y轴比例尺（线性比例尺）</span></div><div class="line">                            .domain([<span class="number">0</span>,d3.max(dataset)])</div><div class="line">                            .range([<span class="number">0</span>,yAxisWidth]);</div><div class="line"></div><div class="line">            <span class="comment">// 添加矩形和文字元素</span></div><div class="line">            <span class="keyword">var</span> rect = svg.selectAll(<span class="string">"rect"</span>)</div><div class="line">                            .data(dataset)</div><div class="line">                            .enter()  <span class="comment">//获取enter部分</span></div><div class="line">                            .append(<span class="string">"rect"</span>)	<span class="comment">//添加rect元素，使其与绑定数组的长度一致</span></div><div class="line">                            .attr(<span class="string">"fill"</span>,<span class="string">"steelblue"</span>)</div><div class="line">                            .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span><span class="params">(d,i)</span></span>&#123;	<span class="comment">//设置X坐标</span></div><div class="line">                                <span class="comment">// return padding.left + i * rectStep;</span></div><div class="line">                                <span class="keyword">return</span> padding.left + xScale(i);</div><div class="line"></div><div class="line">                            &#125;)</div><div class="line">                            .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span><span class="params">(d,i)</span></span>&#123;	<span class="comment">//设置Y坐标</span></div><div class="line">                                <span class="comment">// return height - padding.bottom - d;</span></div><div class="line">                                <span class="keyword">return</span> height - padding.bottom - yScale(d);</div><div class="line">                            &#125;)</div><div class="line">                            .attr(<span class="string">"width"</span>,xScale.rangeBand())    <span class="comment">//设置矩形宽度</span></div><div class="line">                            .attr(<span class="string">"height"</span>,<span class="function"><span class="keyword">function</span><span class="params">(d)</span></span>&#123;</div><div class="line">                                <span class="keyword">return</span> yScale(d);</div><div class="line">                            &#125;)</div><div class="line">            <span class="keyword">var</span> text = svg.selectAll(text)</div><div class="line">                            .data(dataset)</div><div class="line">                            .enter()</div><div class="line">                            .append(<span class="string">"text"</span>)</div><div class="line">                            .attr(<span class="string">"fill"</span>,<span class="string">"white"</span>)</div><div class="line">                            .attr(<span class="string">"font-size"</span>,<span class="string">"14px"</span>)</div><div class="line">                            .attr(<span class="string">"text-anchor"</span>,<span class="string">"middle"</span>)</div><div class="line">                            .attr(<span class="string">"x"</span>,<span class="function"><span class="keyword">function</span><span class="params">(d,i)</span></span>&#123;	<span class="comment">//与矩形的X坐标一样</span></div><div class="line">                                <span class="keyword">return</span> padding.left + xScale(i);</div><div class="line">                            &#125;)</div><div class="line">                            .attr(<span class="string">"y"</span>,<span class="function"><span class="keyword">function</span><span class="params">(d)</span></span>&#123;</div><div class="line">                                <span class="keyword">return</span> height - padding.bottom - yScale(d);</div><div class="line">                            &#125;)</div><div class="line">                            .attr(<span class="string">'dx'</span>, xScale.rangeBand()/<span class="number">2</span>)	<span class="comment">//x轴相对平移距离</span></div><div class="line">                            .attr(<span class="string">'dy'</span>, <span class="string">"1em"</span>)	<span class="comment">//em单位表示的是当前文字所占一行的高度</span></div><div class="line">                            .text(<span class="function"><span class="keyword">function</span><span class="params">(d)</span></span>&#123;	<span class="comment">//要显示的文字内容</span></div><div class="line">                                <span class="keyword">return</span> d;</div><div class="line">                            &#125;);</div><div class="line"></div><div class="line">            <span class="comment">// 定义坐标轴</span></div><div class="line">            <span class="keyword">var</span> xAxis = d3.svg.axis()</div><div class="line">                        .scale(xScale)</div><div class="line">                        .orient(<span class="string">"bottom"</span>);</div><div class="line">            yScale.range([yAxisWidth,<span class="number">0</span>]);</div><div class="line">            <span class="keyword">var</span> yAxis = d3.svg.axis()</div><div class="line">                        .scale(yScale)</div><div class="line">                        .orient(<span class="string">"left"</span>);</div><div class="line">                        </div><div class="line">            <span class="comment">// 添加坐标轴</span></div><div class="line">            svg.append(<span class="string">"g"</span>)</div><div class="line">              .attr(<span class="string">"class"</span>,<span class="string">"axis"</span>)</div><div class="line">              .attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + padding.left + <span class="string">","</span> + (height - padding.bottom) + <span class="string">")"</span>)</div><div class="line">              .call(xAxis);</div><div class="line"></div><div class="line">            svg.append(<span class="string">"g"</span>)</div><div class="line">              .attr(<span class="string">"class"</span>,<span class="string">"axis"</span>)</div><div class="line">              .attr(<span class="string">"transform"</span>,<span class="string">"translate("</span> + padding.left + <span class="string">","</span> + (height - padding.bottom - yAxisWidth) + <span class="string">")"</span>)</div><div class="line">              .call(yAxis);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h1 id="「参考资料」"><a href="#「参考资料」" class="headerlink" title="「参考资料」"></a>「参考资料」</h1><blockquote>
<p> <a href="http://d3.decembercafe.org/index.html" target="_blank" rel="external">【Learning D3.JS】</a><br> <a href="http://www.cnblogs.com/koto/p/5980646.html" target="_blank" rel="external">【D3.js：Update、Enter、Exit】</a><br> <a href="http://wiki.11ten.net/Tools/d3.js.html" target="_blank" rel="external">【D3.js - 初体验】</a><br> <a href="http://blog.csdn.net/zhang__tianxu/article/category/1623437/1" target="_blank" rel="external">【D3.js数据可视化系列教程】</a></p>
</blockquote>
<!-- - http://upload-images.jianshu.io/upload_images/4762054-01d82ecd4ac11abc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 -->
<!-- ![Sankey](http://upload-images.jianshu.io/upload_images/4762054-ae18d0fdf352e30a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) -->
<!-- ![Chord](http://ommtyfkn6.bkt.clouddn.com/chord.gif) -->]]></content>
      
        <categories>
            
            <category> D3.js </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 数据可视化 </tag>
            
            <tag> D3.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Semantic UI上手]]></title>
      <url>JuniorNi.github.io/2017/03/18/Semantic-UI%E4%B8%8A%E6%89%8B/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/4762054-abb3edf07ba4b920.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>最近使用<code>Semantic UI</code>这一CSS框架实现了上图的苹果静态官网首页，我只想说，要不要这么简单粗暴！它省去了你大量时间与经历，不必去重复造轮子。但如此的便利必然是付出了某种你还未发现的代价……</p>
<a id="more"></a>
<h1 id="Semantic-UI基础知识"><a href="#Semantic-UI基础知识" class="headerlink" title="Semantic UI基础知识"></a>Semantic UI基础知识</h1><p>我们要了解一些基本的样式与技巧，并能通过使用“形容词”来改变样式。</p>
<h2 id="【基本样式】"><a href="#【基本样式】" class="headerlink" title="【基本样式】"></a>【基本样式】</h2><p>首先，<code>header</code>中导入<code>semantic</code>样式，在<code>body</code>的<code>div</code>块中定义<code>class=“ui segment”</code>，基本效果如下<br><img src="http://upload-images.jianshu.io/upload_images/4762054-d931b46a42c7f283.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="【使用“形容词”】"><a href="#【使用“形容词”】" class="headerlink" title="【使用“形容词”】"></a>【使用“形容词”】</h2><p>其次，在<code>div class = &quot;XXX&quot;</code>中加上你想实现的“形容词”</p>
<ul>
<li>inverted + color</li>
<li>vertical</li>
<li>padded</li>
</ul>
<h3 id="inverted"><a href="#inverted" class="headerlink" title="inverted"></a>inverted</h3><p> 颜色反转，若不加颜色，则直接变成黑色，官网给出下面多种颜色选择<br><img src="http://upload-images.jianshu.io/upload_images/4762054-a3920b371c3a6230.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="img"></p>
<h3 id="vertical"><a href="#vertical" class="headerlink" title="vertical"></a>vertical</h3><p>消除两边的圆角、阴影，同一<code>vertical</code>作用下的多个<code>segment</code>之间缝隙消失，<br><img src="http://upload-images.jianshu.io/upload_images/4762054-cedff6d05992d74a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<h3 id="padded"><a href="#padded" class="headerlink" title="padded"></a>padded</h3><p>改变内距</p>
<h1 id="Apple静态官网首页实现"><a href="#Apple静态官网首页实现" class="headerlink" title="Apple静态官网首页实现"></a>Apple静态官网首页实现</h1><p>了解了必要的知识之后，赶紧来实践一番！</p>
<h2 id="【导航菜单栏】"><a href="#【导航菜单栏】" class="headerlink" title="【导航菜单栏】"></a>【导航菜单栏】</h2><p><img src="http://upload-images.jianshu.io/upload_images/4762054-6475ff8105f883f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>使用<code>semantic</code>自带的<code>ui menu</code>样式，第一个与最后两个使用图标插入，其余的直接输文字，这里有几个小点需要注意：</p>
<ul>
<li>fixed：固定菜单栏，下拉拖动时表头不会消失，一直悬浮在最上面</li>
<li>fitted：大小宽度自适应</li>
<li>nine item：九个图标居中显示</li>
<li>borderless：去除图案之间的白色间隔线</li>
</ul>
<p><em><u>代码如下</u></em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui fixed fitted inverted borderless nine item menu"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\appleicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Mac<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Music<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>技术支持<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\searchicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\buyicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="【iPhone7大图】"><a href="#【iPhone7大图】" class="headerlink" title="【iPhone7大图】"></a>【iPhone7大图】</h2><p><img src="http://upload-images.jianshu.io/upload_images/4762054-c44b29136d0ec9ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>使用<code>ui image</code>样式插入图片，其他注意点：</p>
<ul>
<li>basic：消除黑边</li>
<li>secondary：相当于下面的效果<br>  <img src="http://upload-images.jianshu.io/upload_images/4762054-b39d0c79e40c621b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br>  但是在这里可以从视觉效果上去除图片下的底色，否则会是下面这样，要多难看有多难看…<br>  <img src="http://upload-images.jianshu.io/upload_images/4762054-a75dab13eac754ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></li>
</ul>
<p><em><u>代码如下</u></em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui basic secondary vertical segment"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/banner.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="【四张小图】"><a href="#【四张小图】" class="headerlink" title="【四张小图】"></a>【四张小图】</h2><p><img src="http://upload-images.jianshu.io/upload_images/4762054-2477cad6f4d194d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><em><u>代码如下</u></em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui basic secondary vertical segment"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui fitted text menu"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img1.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img2.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img3.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img4.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="【最后文字】"><a href="#【最后文字】" class="headerlink" title="【最后文字】"></a>【最后文字】</h2><p><img src="http://upload-images.jianshu.io/upload_images/4762054-c46086dff62d64f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>使用嵌套制作网页<code>ui segment -&gt; ui container</code>，注意事项：</p>
<ul>
<li>very padded：内距变大</li>
<li>一条分割线：通过<code>&lt;div class=&quot;ui divider&quot;&gt;&lt;/div&gt;</code>方式“画出”一条分割线</li>
<li>grid：网格系统，使用<code>five column</code>分成五列</li>
<li>text menu：每段文字放在里面，且用<code>vertical</code>垂直排列</li>
</ul>
<p><em><u>代码如下</u></em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical secondary very padded segment"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui container"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sub header"</span>&gt;</span></div><div class="line">            双镜头摄像头仅于 iPhone 7 Plus 提供。亮黑色外观仅于 128GB 及以上存储容量的机型提供。</div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui five column grid"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 段落重复4遍ing --&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>好了，最后把‘导航菜单栏’、‘iPhone7大图’、‘四张小图’与‘最后文字’四块部分拼接起来，就实现了苹果官网首页的效果，耶~</p>
<h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/semantic.css"</span> <span class="attr">media</span>=<span class="string">"screen"</span> <span class="attr">title</span>=<span class="string">"no title"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 导航栏 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui fixed fitted inverted borderless nine item menu"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\appleicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Mac<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Music<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>技术支持<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\searchicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images\buyicon.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 表头图片 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui basic secondary vertical segment"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui image"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/banner.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 四张图、 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui basic secondary vertical segment"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui fitted text menu"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img1.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img2.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img3.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"ui image"</span> <span class="attr">src</span>=<span class="string">"images/img4.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- 最后文字 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical secondary very padded segment"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui container"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sub header"</span>&gt;</span></div><div class="line">                    双镜头摄像头仅于 iPhone 7 Plus 提供。亮黑色外观仅于 128GB 及以上存储容量的机型提供。</div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="comment">&lt;!-- 文字重复中 --&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui five column grid"</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"column"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui vertical text menu"</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">                                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>Apple Store 商店<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>查找零售店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPad<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>Watch<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>iPod<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><blockquote>
<p><a href="https://semantic-ui.com/" target="_blank" rel="external">Semantic UI 官网</a><br><a href="http://www.semantic-ui.cn/introduction/getting-started.html" target="_blank" rel="external">Semantic UI 中文文档</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Web开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Web </tag>
            
            <tag> Css </tag>
            
            <tag> Semantic UI </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[如何成为技术大牛]]></title>
      <url>JuniorNi.github.io/2017/03/15/%E5%A6%82%E4%BD%95%E6%88%90%E4%B8%BA%E6%8A%80%E6%9C%AF%E5%A4%A7%E7%89%9B/</url>
      <content type="html"><![CDATA[<p>前几日朋友分享了一篇“技术大牛养成指南”，看完之后有种豁然开朗的感觉，这也许和我最近的状态有关，最近一直没想通的问题似乎在这篇文章中也得到解决。作者通过目标拆解，用可实践的方法来指导大家如何在日常生活与工作中去运用。</p>
<a id="more"></a>
<h1 id="什么是1万小时理论"><a href="#什么是1万小时理论" class="headerlink" title="什么是1万小时理论"></a>什么是1万小时理论</h1><p>成为顶级专家的<strong>唯一</strong>方法就是1万小时持续不断地练习，意味着每天如果花3小时来提升自己的技能，需要10年…（不能包括你每天的重复性工作时间，要从专业广度与深度上不断扩展）</p>
<h1 id="如何找到1万小时"><a href="#如何找到1万小时" class="headerlink" title="如何找到1万小时"></a>如何找到1万小时</h1><ol>
<li>每天的起床前与睡前30分钟：你会感到每天平白无故比别人多了一、两个小时</li>
<li>利用或节省路途时间</li>
<li>周末4小时</li>
</ol>
<h1 id="如何坚持下去"><a href="#如何坚持下去" class="headerlink" title="如何坚持下去"></a>如何坚持下去</h1><ol>
<li>分解等级<ul>
<li>0~1年：菜鸟，需要手把手教</li>
<li>1~3年：初级，要别人带你</li>
<li>3~5年：高级，独挡一面，能带初级技术人员</li>
<li>5~8年：资深，独挡多面</li>
<li>8~10年：大牛，统筹规划，高屋建瓴</li>
</ul>
</li>
</ol>
<ol>
<li><p>分解技能<br>每一段目标持续2~3年，哪里不懂补哪里，最好以<strong>6个月</strong>为周期</p>
</li>
<li><p>分解行动<br>把技能目标分解为具体要做的事，把6个月的目标分解为1个月的目标</p>
</li>
</ol>
<h1 id="如何在工作中提升自我"><a href="#如何在工作中提升自我" class="headerlink" title="如何在工作中提升自我"></a>如何在工作中提升自我</h1><p>掌握业务代码中的技术后期并不会让你提升经验值，必须打更高级的怪、刷副本，没有一直打小怪就能升到顶级。你要不断的提升自己的水平，然后面临更大的挑战，从而使自己水平更上一级。</p>
<h2 id="Do-more"><a href="#Do-more" class="headerlink" title="Do more"></a>Do more</h2><ol>
<li>去熟悉更多系统、业务、代码，不管是不是你所负责的</li>
<li>善于自学。「唯一不变的只有变化」，我们更加需要自学更多东西，因为真正等到要用的时候再来学已经没有时间了</li>
</ol>
<h2 id="Do-better"><a href="#Do-better" class="headerlink" title="Do better"></a>Do better</h2><p>你负责的系统和业务，总有不合理和可以改进的地方。这些“不合理”和“可改进”的地方，都是更高级别的怪物，打完后能够增加更多的经验值。</p>
<h2 id="Do-exercise"><a href="#Do-exercise" class="headerlink" title="Do exercise"></a>Do exercise</h2><p>印第安人有一句谚语：I hear and I forget. I see and I remember. I do and I understand.<br>其实方法很简单：learning、trying、teaching</p>
]]></content>
      
        <categories>
            
            <category> 职业发展 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[《大数据与机器学习》读书笔记（一） 数据与数据平台]]></title>
      <url>JuniorNi.github.io/2017/03/12/%E3%80%8A%E5%A4%A7%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%20%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/</url>
      <content type="html"><![CDATA[<h1 id="数据环境与数据形态"><a href="#数据环境与数据形态" class="headerlink" title="数据环境与数据形态"></a>数据环境与数据形态</h1><p>对于企业经营中产生的数据有三种形态：</p>
<ul>
<li><strong>生产数据</strong>：指某个生产系统的生产环境数据库中的数据。它会随着业务应用的变化而变化，是动态的，如用户的账户余额数据。</li>
<li><strong>原始数据：</strong>对生产数据的解耦，包括数据脱敏、字段筛选、批量导出（将动态数据的“快照”保存下来）。其目的是为了防止生产数据与分析数据的数据直连，带来数据管理与应用的灾难</li>
<li><strong>分析数据：</strong>对原始数据进行ETL之后的数据，主要从<u><em>属性筛选</em></u>、<u><em>标准统一</em></u>（如数据格式与字段含义的不一致）、<u><em>优化存储</em></u>（如创建索引，分区，分表存储）的角度进行ETL。</li>
</ul>
<a id="more"></a>
<h1 id="数据仓库平台"><a href="#数据仓库平台" class="headerlink" title="数据仓库平台"></a>数据仓库平台</h1><p>数仓本质是解决大批量数据的<strong>入口</strong>与<strong>出口</strong>问题，为分析与应用提供支持。该书作者认为能稳定提供 <u><em>“顺滑”</em></u> 数据服务的数仓需要注下面两点：</p>
<ol>
<li><p><strong>更新规则：</strong></p>
<p>分全量更新与增量更新两种方式。更新过程中要注意<em>“部分提交”</em>与<em>“数据断档”</em>问题，可行的解决方案是<u><em>增加中间表</em></u>，如图</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4762054-6978ed57d2129568.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20170212_1.jpg"></p>
</li>
<li><p><strong>存储规则：</strong></p>
<p>分析发现，数仓用户使用的交易数据90%集中在近三个月，60%的作业仅集中在近一个月。所以可行的办法是“<u><em>大表拆小表，小表组视图</em></u>”，提高访问效率。 </p>
</li>
</ol>
<h1 id="大数据平台"><a href="#大数据平台" class="headerlink" title="大数据平台"></a>大数据平台</h1><p>之前一直把Hive与Hbase的概念混淆，趁此机会搞清楚。</p>
<table>
<thead>
<tr>
<th style="text-align:center">Hbase</th>
<th style="text-align:center">Hive</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">基于HDFS的非关系型数据库（KV型）</td>
<td style="text-align:center">关系型数据结构，是用SQL替代写MR的编程框架</td>
</tr>
<tr>
<td style="text-align:center">物理表，适合存放非结构化的数据</td>
<td style="text-align:center">纯逻辑表，本身不存储数据，完全依赖于HDFS和MR</td>
</tr>
<tr>
<td style="text-align:center">处理数据是基于列的模式</td>
<td style="text-align:center">基于MR处理数据,而MR是基于行的模式</td>
</tr>
<tr>
<td style="text-align:center">HBase是为了支持弥补Hadoop对实时操作的缺陷的项目</td>
<td style="text-align:center">Hive是建立在Hadoop之上为了减少MapReduce jobs编写工作的批处理系统</td>
</tr>
<tr>
<td style="text-align:center">适合实时查询</td>
<td style="text-align:center">适合查询分析统计</td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> 读书笔记 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[matplotlib绘图－斜上抛运动]]></title>
      <url>JuniorNi.github.io/2017/03/11/matplotlib%E8%BF%90%E7%94%A8%EF%BC%8D%E6%96%9C%E4%B8%8A%E6%8A%9B%E8%BF%90%E5%8A%A8/</url>
      <content type="html"><![CDATA[<p>matplotlib是Python中绘制2D图形使用最多的库，可以很轻松的将数据图形化。本文绘制了斜上抛运动，下面是最终的效果。</p>
<p><img src="http://ommtyfkn6.bkt.clouddn.com/up.gif" style="width: 350px;"><br>（菲菲老师教得好，幸不辱命 (•‾̑⌣‾̑•)✧˖° ）</p>
<a id="more"></a>
<h1 id="「准备工作」"><a href="#「准备工作」" class="headerlink" title="「准备工作」"></a>「准备工作」</h1><ol>
<li><p><strong>导入所需数据包</strong><br>这里的animation.FuncAnimation（fig，update，generate，interval = 5）函数，是用于生成动态图片的。其中fig表示生成的图表对象；generate函数生成数据后传递给update函数更新，这样数据不断更新，图形也不停变化；interval表示时间间隔，设置的值越小，运动速度越快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> animation	</div><div class="line"><span class="keyword">import</span> math</div></pre></td></tr></table></figure>
</li>
<li><p><strong>设置图形窗口参数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 中文字体路径设置，防止中文不显示</span></div><div class="line">font=FontProperties(fname=<span class="string">r"c:\windows\fonts\simsun.ttc"</span>,size=<span class="number">14</span>)</div><div class="line"></div><div class="line"><span class="comment"># 初始化图形窗口</span></div><div class="line">fig = plt.figure()</div><div class="line">ax = fig.add_subplot(<span class="number">111</span>)	</div><div class="line">ax.set_aspect(<span class="string">'equal'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 设置坐标轴的x,y取值范围</span></div><div class="line">xmin = <span class="number">0</span></div><div class="line">ymin = <span class="number">0</span></div><div class="line">ax = plt.axes(xlim = (xmin, xmax), ylim = (ymin, ymax)) </div><div class="line"></div><div class="line"><span class="comment"># 创建一个圆，圆点在（0,0），半径为1</span></div><div class="line">circle = plt.Circle((xmin, ymin), <span class="number">1</span>)</div><div class="line">ax.add_patch(circle)</div></pre></td></tr></table></figure>
</li>
<li><p><strong>给定初始参数值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">g = <span class="number">9.8</span></div><div class="line">u = <span class="number">30</span>	<span class="comment"># 斜上抛的初速度</span></div><div class="line">theta = <span class="number">60</span>	<span class="comment"># 与水平方向的夹角θ</span></div><div class="line">theta_radians = math.radians(theta)	<span class="comment"># 返回一个角度的弧度值</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>计算衍生参数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">t_flight= <span class="number">2</span>*u*math.sin(theta_radians)/g		<span class="comment"># 从A点到B点所需时间</span></div><div class="line">t_max = u*math.sin(theta_radians)/g	<span class="comment"># 上升到最大高度所需时间</span></div><div class="line">xmax = u*math.cos(theta_radians)*t_flight  <span class="comment"># AB两点的距离</span></div><div class="line">ymax = u*math.sin(theta)*t_max - <span class="number">0.5</span>*g*t_max**<span class="number">2</span>  <span class="comment"># 上升的最大高度</span></div></pre></td></tr></table></figure>
<p> <img src="http://upload-images.jianshu.io/upload_images/4762054-f358ae7ae1e3e1bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="width: 500px;"></p>
</li>
</ol>
<h1 id="「制作动态效果」"><a href="#「制作动态效果」" class="headerlink" title="「制作动态效果」"></a>「制作动态效果」</h1><p>主要利用前面介绍的animation.FuncAnimation函数。于是我们需要构造generate与update函数，让它动起来~</p>
<p><strong>generate函数</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#产生时间间隔参数（每个数据间隔为0.05），依次传递给updata函数   </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">()</span>:</span></div><div class="line">	t = <span class="number">0</span></div><div class="line">	<span class="keyword">while</span> t &lt; t_flight:</div><div class="line">		t += <span class="number">0.05</span></div><div class="line">		<span class="keyword">yield</span> t</div></pre></td></tr></table></figure></p>
<p><strong>update函数</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#更新时间间隔参数，从而不断改变圆的圆心坐标位置，让其移动 </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(t)</span>:</span></div><div class="line">    x = u*math.cos(theta_radians)*t</div><div class="line">    y = u*math.sin(theta_radians)*t - <span class="number">0.5</span>*g*t*t</div><div class="line">    circle.center = x, y</div><div class="line">    <span class="keyword">return</span> circle,</div></pre></td></tr></table></figure></p>
<p><strong>打印相关信息</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Print</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> (<span class="string">u"初始速度（米/秒）:"</span>,u)</div><div class="line">    <span class="keyword">print</span> (<span class="string">u"发射角度（度）"</span>,theta)</div><div class="line">    <span class="keyword">print</span> (<span class="string">u"飞行总时间（秒）"</span>,t_flight)</div><div class="line">    <span class="keyword">print</span> (<span class="string">u"飞行距离（米）"</span>,xmax)</div></pre></td></tr></table></figure></p>
<p><strong>动画函数</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">anim = animation.FuncAnimation(fig, update,generate,interval=<span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment"># 附加信息</span></div><div class="line">anim= animation.FuncAnimation(fig, update,generate,interval=<span class="number">10</span>)</div><div class="line">plt.title(<span class="string">u'导弹发射轨迹'</span>,fontproperties=font)</div><div class="line">plt.xlabel(<span class="string">u'水平距离(米)'</span>,fontproperties=font)</div><div class="line">plt.ylabel(<span class="string">u'导弹运行高度（米）'</span>,fontproperties=font)</div><div class="line">plt.show()</div><div class="line">Print()</div></pre></td></tr></table></figure></p>
<p>最后就能看到首页的动态图了 ヾ(◍’౪`◍)ﾉﾞ</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[R数据可视化－动态、交互式地图神器（三）自定义Marker]]></title>
      <url>JuniorNi.github.io/2017/03/08/R%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%EF%BC%8D%E5%8A%A8%E6%80%81%E3%80%81%E4%BA%A4%E4%BA%92%E5%BC%8F%E5%9C%B0%E5%9B%BE%E7%A5%9E%E5%99%A8%EF%BC%88%E4%B8%89%EF%BC%89%E7%AC%A6%E5%8F%B7%E6%A0%87%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="Leaflet-LeafletCN-系列"><a href="#Leaflet-LeafletCN-系列" class="headerlink" title="Leaflet/LeafletCN 系列"></a>Leaflet/LeafletCN 系列</h1><p><a href="http://www.jianshu.com/p/5211d151308f" target="_blank" rel="external">R数据可视化－动态、交互式地图神器（一）概述与实现</a><br><a href="http://www.jianshu.com/p/c74656950836" target="_blank" rel="external">R数据可视化－动态、交互式地图神器（二）地图与定位</a>   </p>
<a id="more"></a>
<p>特别喜欢Leaflet的marker自定义，主要有以下几种标记方法</p>
<h2 id="【标记】"><a href="#【标记】" class="headerlink" title="【标记】"></a>【标记】</h2><ul>
<li>addMarkers(popup,icon)   </li>
<li>awesomeMarker(icon,library, markerColor,iconColor )</li>
<li><p>addCircleMarker(popup,color,fillOpacity)</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"> popup：文字描述</span></div><div class="line">-<span class="ruby"> icon：自定义图标</span></div><div class="line"></div><div class="line">-<span class="ruby"> icon：图表类型</span></div><div class="line">-<span class="ruby"> library：图标库</span></div><div class="line">-<span class="ruby"> markerColor：背景颜色</span></div><div class="line">-<span class="ruby"> iconColor ：图标颜色</span></div><div class="line"></div><div class="line">-<span class="ruby"> popup：文字描述</span></div><div class="line">-<span class="ruby"> color：颜色</span></div><div class="line">-<span class="ruby"> fillOpacity：透明度</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="【第一类方法举例】"><a href="#【第一类方法举例】" class="headerlink" title="【第一类方法举例】"></a>【第一类方法举例】</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">df = data.frame(Lat = <span class="number">31</span>+ rnorm(<span class="number">10</span>,<span class="number">0</span>,<span class="number">1</span>), Lon = <span class="number">121</span> + rnorm(<span class="number">10</span>,<span class="number">0</span>,<span class="number">1</span>))  # 生成<span class="number">10</span>个随机点</div><div class="line"></div><div class="line">df   #传数据</div><div class="line">  %&gt;% leaflet()   # 加载地图容器</div><div class="line">  %&gt;% addTiles()  # 加载底图</div><div class="line">  %&gt;% addMarkers()  # 加默认标记</div></pre></td></tr></table></figure>
<p>这种是默认的图标<br><img src="http://upload-images.jianshu.io/upload_images/4762054-9aab31a29346f373.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>接下来自定义icon<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">warIcons &lt;- iconList(  <span class="comment">#自定义icon图标</span></div><div class="line">    <span class="attr">cat</span> = makeIcon(<span class="string">"cat.png"</span>, </div><div class="line">                     <span class="attr">iconWidth</span> = <span class="number">60</span>, <span class="attr">iconHeight</span> = <span class="number">60</span>,</div><div class="line">                     <span class="attr">iconAnchorX</span> = <span class="number">30</span>, <span class="attr">iconAnchorY</span> = <span class="number">30</span>),</div><div class="line">    <span class="attr">dog</span> = makeIcon(<span class="string">"dog.png"</span>, </div><div class="line">                   <span class="attr">iconWidth</span> = <span class="number">60</span>, <span class="attr">iconHeight</span> = <span class="number">60</span>,</div><div class="line">                   <span class="attr">iconAnchorX</span> = <span class="number">30</span>, <span class="attr">iconAnchorY</span> = <span class="number">30</span>)</div><div class="line">)  </div><div class="line"></div><div class="line">geo </div><div class="line">  %&gt;% leaflet()     <span class="comment">#加地图容器</span></div><div class="line">  %&gt;% addProviderTiles(<span class="string">"Thunderforest.SpinalMap"</span>)    <span class="comment">#加地图底图</span></div><div class="line">  %&gt;% addMarkers(<span class="attr">icon=~warIcons[type])</span>    <span class="comment">#使用自定义的icon</span></div></pre></td></tr></table></figure></p>
<p>其中geo数据长这样<br><img src="http://upload-images.jianshu.io/upload_images/4762054-1f9fbb767eb0e2b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="geo"></p>
<p>其中makeIcon用法<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">makeIcon(iconUrl ,iconWidth,iconHeight,iconAnchorX ,iconAnchorY)</div><div class="line"> -<span class="ruby"> iconUrl : 图标的url地址</span></div><div class="line"> -<span class="ruby"> iconWidth ：图标的宽度</span></div><div class="line"> -<span class="ruby"> <span class="symbol">iconHeight:</span> 图标的高度</span></div><div class="line"> -<span class="ruby"> iconAnchorX <span class="symbol">:</span>图标的中心点x轴偏移（以左上角为<span class="number">0</span>,<span class="number">0</span>)</span></div><div class="line"> -<span class="ruby"> iconAnchorY <span class="symbol">:</span>图标的中心点Y轴偏移（以左上角为<span class="number">0</span>,<span class="number">0</span>)</span></div></pre></td></tr></table></figure></p>
<p>效果<br><img src="http://upload-images.jianshu.io/upload_images/4762054-f03c76ada31354f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="猫狗大战"></p>
<h2 id="【第二类方法举例】"><a href="#【第二类方法举例】" class="headerlink" title="【第二类方法举例】"></a>【第二类方法举例】</h2><p>可以在library参数中设定你希望选择的图标库，有以下几个：</p>
<ul>
<li><a href="http://fontawesome.io/icons/" target="_blank" rel="external">fontIcons</a></li>
<li><a href="http://getbootstrap.com/components/#glyphicons" target="_blank" rel="external">glyphicon</a></li>
<li><a href="http://ionicons.com/" target="_blank" rel="external">Ionicons</a></li>
</ul>
<p>如：<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">myIcon</span> = makeAwesomeIcon(<span class="attr">icon</span> = <span class="string">"book"</span>, <span class="attr">library</span> = <span class="string">"glyphicon"</span>,<span class="attr">markerColor</span> = <span class="string">"purple"</span>)</div><div class="line"></div><div class="line">df</div><div class="line">%&gt;% leaflet() </div><div class="line">%&gt;% setView() </div><div class="line">%&gt;% addProviderTiles(<span class="string">"NASAGIBS.ViirsEarthAtNight2012"</span>) </div><div class="line">%&gt;% addAwesomeMarkers(<span class="attr">icon=myIcon)</span></div></pre></td></tr></table></figure></p>
<p>效果<br><img src="http://upload-images.jianshu.io/upload_images/4762054-f83a617c9e564333.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h2 id="【第三类方法举例】"><a href="#【第三类方法举例】" class="headerlink" title="【第三类方法举例】"></a>【第三类方法举例】</h2><p>addCircleMarkers()方法更简单，直接把点作为一个镶边的圆（或者说圆符号）绘制到地图上，如：<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">leaflet<span class="comment">(df)</span> </div><div class="line"><span class="meta">%</span>&gt;<span class="meta">%</span> addProviderTiles<span class="comment">("CartoDB.Positron")</span></div><div class="line"><span class="meta">%</span>&gt;<span class="meta">%</span> addCircleMarkers<span class="comment">()</span></div></pre></td></tr></table></figure></p>
<p>效果<br><img src="http://upload-images.jianshu.io/upload_images/4762054-7119a4682600513c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
]]></content>
      
        <categories>
            
            <category> R </category>
            
        </categories>
        
        
        <tags>
            
            <tag> R </tag>
            
            <tag> Leaflet </tag>
            
            <tag> 数据可视化 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hexo搭建个人博客]]></title>
      <url>JuniorNi.github.io/2017/03/05/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>人啊，总有那么一瞬间，想把自己各种美好与不美好的瞬间，经历与感悟给记录下来。当自己回过头再来看的时候，也许会哭，会笑，酸甜苦辣，各有滋味。当这些点点滴滴汇聚起来之后，估计我会仰天大吼：这一世没白活！<br><a id="more"></a></p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>这个周末在网上各种找资料、跨过无数坑之后，个人博客算是初步完成了。</p>
<h2 id="【目标与要求】"><a href="#【目标与要求】" class="headerlink" title="【目标与要求】"></a>【目标与要求】</h2><ul>
<li>美观：对审美有一定要求，有相对不错的外观</li>
<li>功能：起码能分类、打标签、各种时间维度能归档</li>
<li>学习成本：语言、代码相对更容易，学习成本相对较低</li>
<li>时间与金钱成本：最好不用花钱（能省点是一点，我的土壕朋友请无视），不用花太多时间在系统运维  </li>
</ul>
<h2 id="【产品选型】"><a href="#【产品选型】" class="headerlink" title="【产品选型】"></a>【产品选型】</h2><ul>
<li>第三方博客平台，如CSDN、博客园、新浪、豆瓣等。可直接写文章，但模板、样式固定，不算难看也不算好看（简书整体不错，简约风，但是不能带标签，而且鸡汤较多…）</li>
<li>博客工具，部分支持MarkDown语法，免去把文本转化为HTML的痛苦，主要有：<ul>
<li><strong>wordpress</strong>：功能强大，要有主机与域名（免费有限制，正经使用的要花钱购买、备案，还要考虑审批部门的效率…你懂的），折腾太费事费时</li>
<li><strong>ghost</strong>：类似wordpress，相对较重，也是动态网站、需要依赖数据库</li>
<li><strong>Jekyll</strong>：静态文件生成器，支持Markdown，能部署到github。依赖较多库，windows用户不友好，无本地预览功能</li>
<li><strong>hexo</strong>：安装简单，依赖少（仅node），中文支持好（台湾人写的），命令少，易于记忆，可本地实现简单预览，支持markdown。  </li>
</ul>
</li>
</ul>
<p>果断选择了<strong>Hexo</strong>，下面是介绍下主角：</p>
<p> “A fast, simple &amp; powerful blog framework, powered by Node.js.”（官方版）。它是一个Node的静态博客框架，因此没有数据库。可直接部署到github上。好处大大的：省去服务器成本，减少系统运维(系统管理、备份、网络)。</p>
<h2 id="【安装操作】"><a href="#【安装操作】" class="headerlink" title="【安装操作】"></a>【安装操作】</h2><ol>
<li><p><strong>安装node.js</strong>：用来生成静态页面[<a href="https://nodejs.org/en/" target="_blank" rel="external">点击安装node</a>]</p>
</li>
<li><p><strong>注册Github账号</strong>：欢迎加入全球最大的同性交友网站ヾ(◍’౪`◍)ﾉﾞ。不限流量、免费提供开放的托管静态页面的网站。<br> <em>注意！新建的Repo一定要与你的github用户名一模一样，如<strong>[username].github.io</strong></em></p>
</li>
<li><p><strong>安装Git</strong>：用于把本地的Hexo内容沟通,传输,部署到Github上。安装教程可参考廖雪峰的博客[<a href="https://git-for-windows.github.io/" target="_blank" rel="external">点击安装Git</a>]<br> <em>以下步骤一定要做！</em></p>
  <figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git config --global user<span class="selector-class">.name</span> <span class="string">"Your Name"</span></div><div class="line">$ git config --global user<span class="selector-class">.email</span> <span class="string">"email@example.com"</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>安装Hexo</strong><br> 在git bash中敲：</p>
 <figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-<span class="keyword">cli</span> -g</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="【构建博客】"><a href="#【构建博客】" class="headerlink" title="【构建博客】"></a>【构建博客】</h2><ol>
<li><p><strong>初始化</strong><br> 创建一个新的文件夹（放你博客的地方），右键点击Git Bash Here，执行：</p>
 <figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo init</span></div></pre></td></tr></table></figure>
<p> 可以通过以下命令查看是否执行成功</p>
 <figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo s</span></div></pre></td></tr></table></figure>
<p> 出现以下代码，恭喜成功~，并在浏览器输入：<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a> 进行本地预览（默认端口4000）</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">INFO  <span class="keyword">Start</span> processing</div><div class="line">INFO  Hexo <span class="keyword">is</span> running <span class="keyword">at</span> <span class="keyword">http</span>://localhost:<span class="number">4000</span>/. Press Ctrl+C <span class="keyword">to</span> stop.</div></pre></td></tr></table></figure>
<p> <img src="/images/hexo.png" alt=""></p>
</li>
<li><p><strong>配置与部署</strong><br> 我们看到之前创建的博客所在文件夹结构：</p>
<blockquote>
<p>Blog<br> 　｜<br> 　｜－－ .deploy_git<br> 　｜－－ node_modules<br> 　｜－－ scaffolds<br> 　｜－－ source<br> 　｜－－ themes<br> 　｜－－ _config.yml<br> 　｜－－ _gitinore<br> 　｜－－ db.json<br> 　｜－－ package.json<br> 　｜－－ debug.log </p>
</blockquote>
<p> 现在需要_config.yml与我们github用户名对应的仓库建立联系。打开<code>_config.yml</code>文件，拉到最后对应修改：</p>
 <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">type: git</div><div class="line">repo: <span class="link">http://github.com/</span>[<span class="string">username</span>]/[username].github.io</div></pre></td></tr></table></figure>
<p> 并部署：</p>
 <figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hexo clean      # 清除缓存</div><div class="line">hexo <span class="keyword">generate</span>   # 生成静态页面</div><div class="line">hexo deploy     # 上传部署</div></pre></td></tr></table></figure>
</li>
</ol>
<p>到现在，我们的“简装房”就有了，后续需要通过主题替换与各种功能设置，来鸟枪换大炮，变成“精装房”(▰˘◡˘▰) ~。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><blockquote>
<p><a href="https://hexo.io/zh-cn/" target="_blank" rel="external">Hexo 中文文档</a> 【包涵：文档、API、插件、主题】<br><a href="http://theme-next.iissnan.com/" target="_blank" rel="external">NexT 使用文档</a>【包含：开始使用、主题配置、第三方服务、内建标签、常见问题】</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Hexo </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> NexT </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
